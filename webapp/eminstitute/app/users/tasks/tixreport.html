<div class="maincontent">
	#if($canviewsettings)
	<!--  $collectionid will be changed and looped from list of all active clients.-->
		#set( $hits = $mediaarchive.query("librarycollectionusers").orgroup("followeruser",$user.getId()).enduser(true).search() )
	#if ($hits)
		<div class="goals-header-actions">
		<strong> [[You are apart of $hits.size() projects.]]</strong>
		</div>
		<div class="emdata" style="overflow-x:auto;">
		<table width="100%" class="table table-striped table-hover">
		<thead>
		<tr class="tableheader">
			<th style="width:130px">[[Client]]</th>
			<th style="width:130px">[[Status]]</th>
			<th style="width:130px">[[Lvl 1 New]]</th>
			<th style="width:130px">[[Lvl 1 Open]]</th>
			<th style="width:130px">[[Lvl 1 Closed]]</th>
			<th style="width:130px">[[Lvl 2 New]]</th>
			<th style="width:130px">[[Lvl 2 Open]]</th>
			<th style="width:130px">[[Lvl 2 Closed]]</th>
			<th style="width:130px">[[Lvl 3 New]]</th>
			<th style="width:130px">[[Lvl 3 Open]]</th>
			<th style="width:130px">[[Lvl 3 Closed]]</th>
			

			
		</tr>
		</thead>
		#foreach($hit in $hits)
			<tr>
			
			<td >
			#set( $project= $mediaarchive.getData("librarycollection",$hit.collectionid) )
			$project
			</td>
			<td align="center">
			#set($open = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).orgroup("projectstatus","open").enduser(true).search() )
			#if($open > 20) )
			<i class="far fa-angry fa-2x"></i>
			#elseif($open > 15)
			<i class="far fa-sad fa-2x"></i>
			#elseif($open > 10)
			<i class="far fa-meh fa-2x"></i>
			#else
			<i class="far fa-smile fa-2x"></i>
			#end
			</td>
			<td style="background-color: #ffce00">
			#set($newOne = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").after("creationdate",$date).enduser(true).search() )
			$newOne.size()
			</td>
			<td style="background-color: #ffce00">
			#set($openOne = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","open").enduser(true).search() )
			$openOne.size()
			</td>
			<td style="background-color: #ffce00">
			#set($oneClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","completed").enduser(true).search() )
			$oneClosed.size()			
			</td>
			<td style="background-color: #9af000">
			#set($newTwo = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").after("creationdate",$date).enduser(true).search() )
			$newTwo.size()
			</td>
			<td style="background-color: #9af000">
			#set($openTwo = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","open").enduser(true).search() )
			$openTwo.size()
			</td>
			<td style="background-color: #9af000">
			#set($twoClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","completed").enduser(true).search() )
			$twoClosed.size()			
			</td>	
			<td style="background-color: #07b9fc">
			#set($newThree = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").after("creationdate",$date).enduser(true).search() )
			$newThree.size()
			</td>
			<td style="background-color: #07b9fc">
			#set($openThree = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","open").enduser(true).search() )
			$openThree.size()
			</td>
			<td style="background-color: #07b9fc">
			#set($threeClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","completed").enduser(true).search() )
			$threeClosed.size()			
			</td>	
		</tr>
		#end
		</table>
		</div>
	#end
#end
</div>



