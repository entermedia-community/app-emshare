<div class="maincontent">
	#if($canviewsettings)
	<!--  $collectionid will be changed and looped from list of all active clients.-->
		#set( $hits = $mediaarchive.query("librarycollectionusers").orgroup("followeruser",$user.getId()).enduser(true).search() )
	#if ($hits)
		<div class="goals-header-actions">
		<strong> [[You are apart of $hits.size() projects.]]</strong>
		</div>
		<div class="emdata" style="overflow-x:auto;">
		<table width="100%" class="table table-striped table-hover">
		<thead>
		<tr class="tableheader">
			<th style="width:130px">[[Client]]</th>
			<th style="width:130px">[[Status]]</th>
			<th style="width:130px">[[Lvl 1 New]]</th>
			<th style="width:130px">[[Lvl 1 Open]]</th>
			<th style="width:130px">[[Lvl 1 Closed]]</th>
			<th style="width:130px">[[Lvl 2 New]]</th>
			<th style="width:130px">[[Lvl 2 Open]]</th>
			<th style="width:130px">[[Lvl 2 Closed]]</th>
			<th style="width:130px">[[Lvl 3 New]]</th>
			<th style="width:130px">[[Lvl 3 Open]]</th>
			<th style="width:130px">[[Lvl 3 Closed]]</th>
			

			
		</tr>
		</thead>
		#foreach($hit in $hits)
			<tr>
			
			<td >
			#set( $project= $mediaarchive.getData("librarycollection",$hit.collectionid) )
			$project
			</td>
			<td align="center">
			#set($open = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).orgroup("projectstatus","open").enduser(true).search() )
			#if($open.size() > 19) 
			<i class="far fa-angry fa-2x"></i>
			#elseif($open.size() > 14)
			<i class="far fa-sad fa-2x"></i>
			#elseif($open.size() > 9)
			<i class="far fa-meh fa-2x"></i>
			#else
			<i class="far fa-smile fa-2x"></i>
			#end
			</td>
			<td style="background-color: #ffce00">
			#set($newOne = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").after("creationdate",$date).enduser(true).search() )
			$newOne.size()
			</td>
			<td style="background-color: #ffce00">
			#set($openOne = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","open").enduser(true).search() )
			#if($openOne.size() >9 )
			<strong>$openOne.size()</strong>
			#else
			$openOne.size()
			#end
			</td>
			<td style="background-color: #ffce00">
			#set($oneClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","completed").enduser(true).search() )
			$oneClosed.size()			
			</td>
			<td style="background-color: #9af000">
			#set($newTwo = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").after("creationdate",$date).enduser(true).search() )
			$newTwo.size()
			</td>
			<td style="background-color: #9af000">
			#set($openTwo = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","open").enduser(true).search() )
			#if($openTwo.size() >9 )
				<strong>$openTwo.size()</strong>
				#else
				$openTwo.size()
			#end
			</td>
			<td style="background-color: #9af000">
			#set($twoClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","completed").enduser(true).search() )
			$twoClosed.size()			
			</td>	
			<td style="background-color: #07b9fc">
			#set($newThree = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").after("creationdate",$date).enduser(true).search() )
			$newThree.size()
			</td>
			<td style="background-color: #07b9fc">
			#set($openThree = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","open").enduser(true).search() )
			#if($openThree.size() >9 )
				<strong>$openThree.size()</strong>
				#else
				$openThree.size()
			#end
			</td>
			<td style="background-color: #07b9fc">
			#set($threeClosed = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","completed").enduser(true).search() )
			$threeClosed.size()			
			</td>	
		</tr>
		#end
		<tr>
		<td><strong>Totals</strong></td>
		<td></td>
		<td>
		#set($sumOneNew = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").after("creationdate",$date).enduser(true).search() )
		#set($sumOneNew = $sumOneNew + $newTot.size())
		#end
		<strong>$sumOneNew</strong>
		</td>
		<td>
		#set($sumOneOpen = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","open").enduser(true).search() )
		#set($sumOneOpen = $sumOneOpen + $newTot.size())
		#end
		<strong>$sumOneOpen</strong>
		</td>
		<td>
		#set($sumOneClosed = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","1").orgroup("projectstatus","completed").enduser(true).search() )
		#set($sumOneClosed = $sumOneClosed + $newTot.size())
		#end
		<strong>$sumOneClosed</strong>
		</td>
		<td>
		#set($sumTwoNew = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").after("creationdate",$date).enduser(true).search() )
		#set($sumTwoNew = $sumTwoNew + $newTot.size())
		#end
		<strong>$sumTwoNew</strong>
		</td>
		<td>
		#set($sumTwoOpen = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","open").enduser(true).search() )
		#set($sumTwoOpen = $sumTwoOpen + $newTot.size())
		#end
		<strong>$sumTwoOpen</strong>
		</td>
		<td>
		#set($sumTwoClosed = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","2").orgroup("projectstatus","completed").enduser(true).search() )
		#set($sumTwoClosed = $sumTwoClosed + $newTot.size())
		#end
		<strong>$sumTwoClosed</strong>
		</td>
		<td>
		#set($sumThreeNew = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").after("creationdate",$date).enduser(true).search() )
		#set($sumThreeNew = $sumThreeNew + $newTot.size())
		#end
		<strong>$sumThreeNew</strong>
		</td>
		<td>
		#set($sumThreeOpen = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","open").enduser(true).search() )
		#set($sumThreeOpen = $sumThreeOpen + $newTot.size())
		#end
		<strong>$sumThreeOpen</strong>
		</td>
		<td>
		#set($sumThreeClosed = 0)
		#foreach($hit in $hits)
		#set($newTot = $mediaarchive.query("projectgoal").orgroup("collectionid",$hit.collectionid).exact("ticketlevel","3").orgroup("projectstatus","completed").enduser(true).search() )
		#set($sumThreeClosed = $sumThreeClosed + $newTot.size())
		#end
		<strong>$sumThreeClosed</strong>
		</td>
		</tr>
		</table>
		</div>
	#end
#end
</div>



