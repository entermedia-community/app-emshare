#set($collectionid = $librarycol.getId())
<div id="subscriberssidebar">
	#if( $caneditcollection)
	<div class="float-right">
	<a class="emdialog btn btn-sm btn-light"
	style="position:absolute; right:25px;"  
		data-allwaysloadpage="true" href="$applink/collective/edit/editcollective.html?collectionid=$librarycol.getId()" 
		title="[[Project Settings]]"><i class="fas fa-cog"></i> [[Settings]]</a>
	</div>
	#end
	<div class="subscribe-area">
		#if( $user )
			#set( $likesearcher = $mediaarchive.getSearcher("librarycollectionlikes") )
			#set( $liked = $likesearcher.query().exact("followeruser",$user.getId()).exact("collectionid",$collectionid).searchOne() )
	
			#if ($liked)
					 <a href="$applink/collective/channel/subscribers/unsubscribe.html?id=${liked.getId()}&collectionid=$librarycol.getId()" 
						class="btn btn-secondary btn-action">[[Un-Subscribe]]</a>
			#else
				<h3>[[Follow The Project]]</h3>
				<form name="followproject" id="followproject" class="ajaxform" style="display:inline-block;" data-targetdiv="subscriberssidebar" action="$applink/collective/channel/subscribers/likesave.html" method="post">
				<input type="hidden" name="save" value="true" />
				<input type="hidden" name="field" value="followeruser" />
				<input type="hidden" name="followeruser.value" value="$user.getId()" />
				<input type="hidden" name="field" value="addeddate" />
				<input type="hidden" name="addeddate.value" value="$storeddate" />
				<input type="hidden" name="field" value="collectionid" />
				<input type="hidden" name="collectionid.value" value="$collectionid" />
				<input type="hidden" name="collectionid" value="$collectionid" />
				 <a href="" class="btn btn-success btn-action submitform" title="[[Get Email Alerts]]"><i class="fas fa-envelope"></i> &nbsp;[[Subscribe]]</a>
				 
				  
				</form>
			#end
			#set( $onteam = $mediaarchive.query("librarycollectionusers").exact("followeruser",$user.getId()).exact("collectionid",$collectionid).search($context) )
			#if(!$onteam)
				<form name="saveprojectsidebar" id="saveprojectsidebar" class="ajaxform" style="display:inline-block;padding:10px;" data-targetdiv="subscriberssidebar" action="$applink/collective/channel/subscribers/teamsave.html" method="post" style="padding-bottom:5px">
							<input type="hidden" name="save" value="true" />
							<input type="hidden" name="field" value="followeruser" />
							<input type="hidden" name="followeruser.value" value="$user.getId()" />
							<input type="hidden" name="field" value="addeddate" />
							<input type="hidden" name="addeddate.value" value="$storeddate" />
							<input type="hidden" name="field" value="collectionid" />
							<input type="hidden" name="collectionid.value" value="$collectionid" />
							<input type="hidden" name="collectionid" value="$collectionid" />
							<input type="hidden" name="field" value="ontheteam" />
							#if($canviewsettings)
							<input type="hidden" name="ontheteam.value" value="true" />
							#else
							<input type="hidden" name="ontheteam.value" value="false" />
							#end
							<input type="submit" class="btn btn-success btn-action" value="[[Request To Join The Team]]" />
				</form>
			#end
		#else
			<h3>[[Follow The Project]]</h3>
			#set($loginok = "$applink/collective/channel/$collectionid/${librarycol.getWebName()}.html")
			<a href="$applink/authentication/login.html?loginokpage=$!loginok" class="btn btn-success" style=""><i class="fas fa-envelope"></i> &nbsp;[[Login to Subscribe]]</a>
		#end	
		
		<div class="subscribe-headline">
			#if( $caneditcollection)
			<a class="oe-dataedit float-right" data-target="#editjoincollectivetext-$librarycol.id" title="[[Edit Join Collective Text]]" data-width="500"	href="#"><i class="fas fa-edit"></i></a>
			#end
			<div class="oe-editable" id="editjoincollectivetext-$librarycol.id" data-dataid="$librarycol.id" data-field="joincollectivetext" data-searchtype="librarycollection">
	   		#if($librarycol.joincollectivetext) 
				$!librarycol.joincollectivetext
			#end
			</div>
		</div>	
	</div>

<div class="subscribers-box text-center">
	<div class="subscribers-box-box">
		<a class="emdialog" data-cancelsubmit="true" title="View Subscribers" href="$applink/collective/channel/subscribers/subscriberslist.html?collectionid=$librarycol.getId()">
			<div class="box-content" style="border-right:1px solid #ddd;">
			<strong>[[Subscribers]]</strong>
			#set( $subscribers = $mediaarchive.query("librarycollectionlikes").exact("collectionid",$collectionid).search($context) )
			<div class="box-number">$subscribers.size()</div>
			</div>
		</a>	
	</div> 

	<div class="subscribers-box-box">
		<a class="emdialog" title="[[Share]]" href="$applink/components/share/embed.html?collectionid=$librarycol.id">
			<div class="box-content">
				<strong>[[Share]]</strong>
				<div class="box-icons">
					<i class="fas fa-share-alt fa-lg"></i>
				</div>
			</div>
		</a>
		<div class="clearfix"></div>
	</div>
</div>


#if(1==2 && $librarycol.collectivedescription)
	<div class="collectivedescription">
	#esc($librarycol.collectivedescription)
	</div>
#end


#if ($librarycol.facebooklink || $librarycol.instagramlink || $librarycol.websitelink)
	<div class="text-center" style="margin:20px;">
	#if ($librarycol.facebooklink)
			<a href="${librarycol.facebooklink}" class="btn btn-light btn-sm" target="_blank" title="[[Follow Us]]"><i class="fab fa-facebook-f"></i></a>
	#end
	#if ($librarycol.instagramlink)
		<a href="${librarycol.instagramlink}" class="btn btn-light btn-sm" target="_blank" title="[[Follow Us]]"><i class="fab fa-instagram"></i></a>
	#end
	#if ($librarycol.websitelink)
		<a href="${librarycol.websitelink}" class="btn btn-light btn-sm" target="_blank"  title="[[Visit Us]]"><i class="fas fa-link"></i></a>
	#end
	</div>
#end

<div class="sidebarbox">

#set( $team = $mediaarchive.query("librarycollectionusers").exact("collectionid",$collectionid).exact("ontheteam",true).search($context) )
<h4>
<div class="float-right">
<a class="emdialog" style="font-size:.8em;" data-cancelsubmit="true" title="[[View Team]]" href="$applink/collective/channel/subscribers/teamlist.html?collectionid=$librarycol.getId()">
$team.size()</a>
</div>

<i class="fas fa-users"></i> [[Team]]</h4>

	
#if( $team.isEmpty()) 
	<p>[[No team yet]]</p>
#else
<div class="row no-gutters" style="margin-bottom:1rem;">
  #foreach( $hit in $team)
	
  	#set( $followeruser = $mediaarchive.getUser($hit.followeruser) )
    #set( $userlink = "$applink/users/${followeruser.getId()}/${followeruser.getAnonNickName()}.html")
	#set( $userimageurl = $mediaarchive.asLinkToProfile($followeruser.assetportrait) )
	#if(!$userimageurl)
		#set( $userimageurl = "$applink/theme/images/user.svg" )
	#end

	<div class="col-md-6" >
	  <div class="teammember">
	  	
	  	<div style="position: absolute; width:32px;" class="table-subscribers">
		<a href="#esc($userlink)" style="display:block; height:32px">
			<img  src="${userimageurl}"  title="$!followeruser.getAnonNickName()" class="img-fluid align-middle usericon" 
			style="position:relative; top:50%; transform: translateY(-50%);"></a>
		</div>
	  	<div style="margin-left:40px; height:34px; position:relative;">
	    <div style="position:relative; top:50%; transform: translateY(-50%);">
	    	<a href="#esc($userlink)" title="$!followeruser.getAnonNickName()">$!followeruser.getAnonNickName()</a></div> 
	   	<div>
	        </div>
		<i></i>
	    </div>
	    
	  </div>
	</div>
  #end
	</div>
	
#end
	#if( $caneditcollection)
	<div class="text-right">
	<a href="$applink/collective/channel/subscribers/usersearch.html?collectionid=${collectionid}" 
		class="emdialog btn btn-primary btn-sm" title="[[Search Users]]">
	<i class="fas fa-search"></i> [[Add Member]]
	</a>
	</div>
	#end
</div>

</div>

$pages.include("$apphome/collective/donate/donatesidebar.html",$context)


<div class="sidebarbox">
<h4><i class="fas fa-globe"></i> [[Community]]</h4>
		<div class="" style="padding-left:6px;">		
	#foreach($library in $librarycol.getLibraries()) 
		<a  href="$applink/organization/projects/${library.id}/${library.name.replaceAll(" ","-")}.html">$library</a>
	#end
		</div>	
</div>

        
 