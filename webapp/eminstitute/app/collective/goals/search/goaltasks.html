#if(!$goalfolder)
	#set( $goalfolder = $context.getRequestParameter("goalfolder"))
	
	#if(!$goalfolder)
		#set( $goalfolder = $context.getPageValue("goalfolder") )
	#end
	
	#if(!$goalfolder)
		#set( $goalfolder = "search" )
	#end
#end
#set( $indialog = $context.getRequestParameter("indialog"))
#set( $target = "tasklist$!indialog#eid($goal.id)")
#set( $onlyopen = $context.getRequestParameter("onlyopen"))
testt $tasks.size()
<div id="$target">
<div  class="goalstaskcontainer">

<table class="table table-sm table-hover table-dark ">
  <tbody>
	#set($points = 0)
	#foreach($task in $tasks)
		#set( $tree =  $mediaarchive.getCategory($task.projectdepartment))
		#if($tree)
			#set( $c = $tree.getInt("goalpoints") )
			#if( $c == 0)
				#set( $c = 10)
			#end
			#set($points = $points + $c)
		#end
		#set($collectionid = $goal.collectionid)
		#set( $edittask = "$applink/collective/goals/task/taskedit.html?id=${task.id}&collectionid=$goal.collectionid&onlyopen=$!onlyopen&targetdiv=$target")
		
			<tr >
			<th id="taskage" scope="row">$task.getAge()</th>
			<td id="tasktype">$task</td>
			<td id="taskowner">$!mediaarchive.getUser($task.completedby).getAnonNickName()</td>
			#set( $comment = $mediaarchive.query("goaltaskcomments").exact("goaltaskid",$task.id) )
			<td id="taskdetails" style="font-size: 0.66rem; width:150px;">
			#if($task.comment.length() > 50)
			$!task.comment.substring(0, 50) ...
			#else
			$!task.comment
			#end
			</td>
			#if ($task.taskstatus == 1)
			#set($color = "#ffc107")
			#elseif ($task.taskstatus == 3)
			#set($color = "#28a745")
			#else
			#set($color = "#868e96")
			#end
			<td id="taskstatus" style="background: $color; width:125px; ">$!mediaarchive.getData("taskstatus",$task.taskstatus)
			<a href="$edittask"
			id="task$task.getId()"
			data-focuson="$task.id"
			data-width="900"
			class="btn btn-xs btn-task taskcomplete$!{task.taskstatus} ajax" 
			data-targetdiv="task$task.getId()" data-oemaxlevel="1" title="$tree.getCategoryPath()" >
			<i class="fas fa-pencil-alt"></i>
			#set( $comment = $mediaarchive.query("goaltaskcomments").exact("goaltaskid",$task.id).match("commenttext","*").sort("dateDown").searchOne() )
			<!-- #if ($comment)
				&nbsp;<i class="fas fa-comment"></i>
			#end -->
			</a></td>
			</tr>
	#end
	</tbody>
	</table>
	<div class="clearfix"></div>	
			
			
	#if($canviewsettings  && $goal.collectionid)
	<a class="emdialog"
		title="[[Add Tasks]]"
		data-cancelsubmit="true"
		data-parameterdata="categoryvalues"
		data-width="1000" 
		data-collectionid="$goal.collectionid"
		data-categoryid="$!selectedcat.getId()"
		data-hitssessionid="$!{goalhits.getSessionId()}"
		data-goalfolder="$!goalfolder" ##tabs
		data-pickone="true"
		data-goalid="$goal.id"
		data-dialogid="picktask"
		data-action="$applink/collective/goals/actions/search/categorypicked.html"
		href="$applink/collective/goals/actions/search/searchtask.html?targetdiv=$target&clearselection=&detailid=category-exact&onlyopen=$!onlyopen"
		 ><i class="fas fa-plus-circle"></i> 
		</a>
		
	#end
	#if (!$onlyopen && $points>0)
		$points
	#end
	
</div>		
</div>	