#set( $terms = $hits.getFilteredTerms($context,"advancedfilter") )
#if($topmodule)
	#set($topmoduleid = $topmodule.getId())
#end

<div class="filtered #if( $librarycol ) filteredinresults #end">
	
#if(1==2)
	#foreach($sort in $hits.searchQuery.getSorts())
	<a href="#" 
		class="filterschangesort  float-left"
		data-sortbyfield="${moduleid}sortby" 
		title='[[Sorted by]] $sort #if($hits.isAscending() ) [[Ascending]] #end'>
	<i class=" fas #if($sort.endsWith("Down")) fa-sort-alpha-up #else fa-sort-alpha-down #end"></i>
	</a>
	#end
#end

	
	#foreach( $term in $terms)

		#if( $librarycol )
			#set($href = "$siteroot$apphome/views/modules/librarycollection/media/index.html?hitssessionid=$!hits.getSessionId()&collectionid=$librarycol.getId()&removeterm=$term.getId()")
			
		#else
			#set($href = "$siteroot$apphome/views/modules/$module.id/index.html?hitssessionid=$!hits.getSessionId()&removeterm=$term.getId()")
		#end
		#if ($nodeID)
		 	#set($href = $href + "&nodeID=${nodeID}")
		#end
	
		<a href="$href"
			class="btn btn-sm btn-blue clearitself ajax float-left"
			style="margin-left:10px;"
			data-targetdiv="applicationcontent"
			data-oemaxlevel="4"
			title="[[Clear]]: $term.getDetail()">$term.getDetail(): 
			
			<strong>
			#foreach( $val in $term.getValueCollection() )
				
			 	#if ($term.getDetail().getId() == "keywords")
					#if( $foreach.count > 1) [[and]] #end
				#else
					#if( $foreach.count > 1) [[or]] #end
				#end
				
				#if($term.getDetail().isList())
					$context.getText( $mediaarchive.getData($term.getDetail().getListId(),$val) )
				#elseif($term.getDetail().isBoolean())
					#if($term.getValue() == "true")
						[[True]]
					#else
						[[False]]
					#end
				#elseif($term.getDetail().isDate())
					#set($op = $term.operation)
					#if($op == "afterdate")
						[[After]]:
					#elseif($op == "beforedate")
						[[Before]]:
					#elseif($op == "betweendates")
						[[Between]]:
					#end
					
		            $term.getValue()
				#else
		            #if($term.getValue())
		                $term.getValue()
		            #elseif($val)
		                $val
		            #end
				#end
				
			#end
			</strong>&nbsp;
			 <i class="fas fa-times"></i></a>
		#end	
		
		
		


		
		#if( $terms && !$terms.isEmpty() )
			
			#if($content.get("section") == "favorites")
				#set($href = "$siteroot$apphome/views/modules/$module.id/favorites.html?hitssessionid=$hits.getSessionId()&clearselection=true&clearfilters=true")
			#else
				#set($href = "$siteroot$apphome/views/modules/$module.id/index.html?hitssessionid=$!hits.getSessionId()&clearselection=true&clearfilters=true")
			#end
			#if ($nodeID)
		 		#set($href = $href + "&nodeID=$!{nodeID}")
			#end
			<a class="ajax btn btn-secondary btn-sm btn-clearall  float-left" 
				style="margin:0 0 0 10px;"
				href="$href" 
				data-targetdiv="applicationcontent" 
				data-oemaxlevel="4" 
				data-updateurl="true"
				title="[[Clear Search Filters]]"><i class="fas fa-times"></i> &nbsp;[[Clear Filters]]</a>
		#end
		
		
		
		
	</div>
	
	
				
					
