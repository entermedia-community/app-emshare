#set( $moduleid = $page.module)

##fix module vs moduleid
#set( $module = $mediaarchive.getCachedData("module",$moduleid))
$context.putPageValue("moduleid", $module.id)
	
#set($searcher = $searcherManager.getSearcher($catalogid, $moduleid))
$context.putPageValue("searcher", $searcher)

#set($isentity = $module.get("isentity"))
$context.putPageValue("isentity", $isentity )


#if (!$nodeID)
	#set($nodeID = $context.getRequestParameter("nodeID"))
	$context.putPageValue("nodeID",$nodeID)
#end

##set what view they are using

#if($moduleid=="asset")
		$context.putPageValue("viewid", "assetresultstable")
		$context.putPageValue("viewpath", "asset/assetresultstable")
			
		##MAIN ALBUMS VIEW
		#ifnull($resultview)
			#set($resultview = $userprofile.get("${moduleid}resultview"))
		#end
		
		#ifnull($resultview)
			#set($resultview = "$module.moduleresultsview")
		#end
		#ifnull($resultview)
			#set($resultview = "grid")
		#end
#elseif($moduleid=="faceprofilegroup")
	#set($resultview = "table")
#else
	##All Other Entities
	$context.putPageValue("viewid", "${moduleid}resultstable")
	$context.putPageValue("viewpath", "${moduleid}/${moduleid}resultstable")
	
	#set($resultview = $userprofile.get("${moduleid}resultview"))

	#if(!$resultview)
		#set($resultview = $content.get("${moduleid}resultview"))
	#end
	#if(!$resultview)
		#set($resultview = $context.getRequestParameter("resultview"))
	#end
	#if(!$resultview)
		#set($resultview = $content.resultview)
	#end
	#if(!$resultview)
		#set($resultview = $module.get("moduleresultsview"))
	#end
	#if(!$resultview)
		#set($resultview = "table")
	#end

#end
	
	$context.putPageValue("searchtype", $moduleid)
	$context.putPageValue("resultview",$resultview)
	
	#if($module.modulerendertype)
		$context.putPageValue("modulerendertype",$module.modulerendertype)
	#else
		$context.putPageValue("modulerendertype","entity")
	#end
	
	$context.putPageValue("moduletotalhits",$moduletotalhits)


	$pages.include("${searchhome}/resultviews.html", $context)
