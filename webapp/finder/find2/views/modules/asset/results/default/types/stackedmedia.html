#if(!$ismodulesearch)
		#set ( $ismodulesearch = $content.get("ismodulesearch") )
#end
#if(!$ismodulesearch)
	#set ( $ismodulesearch = $context.getRequestParameter("ismodulesearch") )
#end

<div id="resultsdiv"
	class="scroll-resultsdiv"
		data-hitssessionid="$!hits.getSessionId()" ##it breaks drag&drop
		data-hitsname="$hits.getHitsName()"
		data-componenthome="$!componenthome"
		data-searchhome="$home${searchhome}"
		data-category="$!category.getId()"
		data-collectionid="$!librarycol.getId()" 
		data-rendertype="$!rendertype"
		data-searchtype="asset" 
		data-pagenum="$!hits.getPage()" 
		data-totalpages="$!hits.getTotalPages()"
		data-module="$!module"
		data-section="$!content.section"
		
		#set( $inputid = $context.getRequestParameter("inputid"))
		data-inputid="$!inputid"
		data-ismaingrid="true"
	
		data-stackedviewpath="stackedmedia.html"
	>


#if( $hideheader &&  $hideheader != "true")
	$pages.include("${searchhome}/resultheader.html",$context) 
#end
<div class="scrollview">
<div class="masonry-grid" 
	data-maxheight="180" 
	data-cellpadding="4"
>

#set($count = 0)
#set($viewerlink = $content.get("assetviewerlink") )
#set($stackedfield = $mediaarchive.getCatalogSettingValue("stackedgalleryfield"))

#foreach( $hit in $hits.getPageOfHits())
	
	$context.putPageValue("hit", $hit)
	
	
	#set($type = $hit.getSearchHit().getType())
	$context.putPageValue("type", $type)

	#set($rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))
	$context.putPageValue("rendertype", $rendertype)

	#set($sourcepath = $hit.sourcepath)
	$context.putPageValue("sourcepath", $hit.sourcepath )
	
	$context.putPageValue("assetid", $hit.id)
	$context.putPageValue("count", $count )

	$context.putPageValue("thumbsize", "mediumplus" )
	
	#set($assetwidth = $mediaarchive.getRealImageWidth($hit))
	$context.putPageValue("assetwidth", "assetwidth" )
	
	#set($assetheight = $mediaarchive.getRealImageHeight($hit))
	$context.putPageValue("assetheight", "assetheight" )
	
	#set($click = "$siteroot$viewerlink?hitssessionid=${hits.getSessionId()}&assetid=${hit.id}")
	$context.putPageValue("click", "click" )
	
	#set($isselected = $hits.isSelectedOnPage(${hit.id}) )
	$context.putPageValue("isselected", "isselected" )
	
	<div class="resultsdivdata masonry-grid-cell stackedplayer-cell assetdraggable resultsassetcontainer #if($isselected) emrowselected #end" 
		id="gallerycell_${hit.id}"
		data-assetid="$hit.id"
		data-dataid="$hit.id"
		style="height:180px;width:250px;" 
		#if($rendertype == "audio")
			data-width="220"
			data-height="180"
		#else
			data-width="$assetwidth"
			data-height="$assetheight"
			$context.putPageValue("thumbheight", "180" ) 
		#end
		>
		$pages.include("${searchhome}/thumbnails/brick.html", $context)
		
	</div>
    #set ( $count = $count + 1) 
#end

</div>
</div>
</div>