##Header for ASSET module

#if( !$hits )
	#set( $hits = $collectionassets)
	$context.putPageValue("hits",$hits)
#end

#if( !$hits )
	#set( $hits = $orderassets)
	$context.putPageValue("hits", $hits)
#end

#if(!$searchtype)
	#set ( $searchtype = $context.getRequestParameter("searchtype") )
#end
#if(!$searchtype)
	#set ( $searchtype = "asset" )
#end

#set( $categoryid = $hits.getInput("categoryid") )
#if (!$categoryid)
	#set( $categoryid = $context.getRequestParameter("category"))
#end
#set( $nodeID = $context.getRequestParameter("nodeID"))
#if (!$categoryid && $nodeID)
	#set( $categoryid = $nodeID )
#end
#if ($categoryid)
	$context.putPageValue("catid",$categoryid)  ##used?
	$context.putPageValue("categoryid",$categoryid)
#end
#if( $categoryid && !$category)
	#set( $category = $mediaarchive.getData("category",$categoryid) )
#end


#if(!$rootcategory)
	#set($rootcategory = $context.getRequestParameter("rootcategory"))
	#if(!$rootcategory)
		#set( $rootcategory = $categoryid)
	#end
	$context.putPageValue("rootcategory",$rootcategory)
#end

#if(!$topmoduleid)
	#set($topmoduleid = $context.getRequestParameter("topmoduleid"))
	$context.putPageValue("topmoduleid",$topmoduleid)
#end

#if(!$maintargetdiv)
	#set($maintargetdiv = $context.getRequestParameter("maintargetdiv"))
	$context.putPageValue("maintargetdiv",$maintargetdiv)
#end

#set( $orderid = $hits.getInput("orderid") )
#if( $orderid )
	#set( $order = $mediaarchive.getData("order",$orderid) )
	$context.putPageValue("order",$order)
#end

#if( !$librarycol && $category ) 
	#set( $librarycol = $mediaarchive.query("librarycollection").orgroup("rootcategory",$category.getParentCategories()).searchOne() )
#end

#if( $librarycol )	
	$context.putPageValue("librarycol",$librarycol)
#end

#set($reloadsearchtype = $searchtype)
#set($librarycollectionassets = $context.findValue("librarycollectionassets"))
#if($searchtype=="librarycollection")
	#if($librarycollectionassets)
		#set($reloadsearchtype = "asset")
	#end
#end

#if(!$maintargetdiv)
	#set ($maintargetdiv = $context.getRequestParameter("maintargetdiv") )
	$context.putPageValue("maintargetdiv",$maintargetdiv)
#end
	
	<div id="resultsheader" class="resultsheader">
	<div id="sub-nav" class="emsubnav sub-nav-${module.id}">
		<ul class="resultsnav">
			#set ($enabled = false)
			#if ($hits.getSelectionSize() && $hits.getSelectionSize()>0)
				#set ($enabled = true)
			#end
			
			
			
			
			#if ($resultview != "map")
			
				#if($searchtype=="librarycollection" && $librarycol )
				<li class=" dropdown">
				<a href="#" class="dropdown-toggle dropdown-noarrow" data-toggle="dropdown" data-bs-toggle="dropdown" title="[[Album Actions]]">
				[[Album]]</a>
					<div class="dropdown-menu">
					 	#if(!$canforcebasiccollections)
						 	#if($cansharecollection )
							 	#set( $editlink = "$siteroot$apphome/views/modules/librarycollection/sharecollection.html?collectionid=${librarycol.getId()}")
							 	<a class="dropdown-item emdialog" data-allwaysloadpage="true" data-hidefooter="true"   href="$editlink" title="[[Sharing Album]]"><i class="dropdown-item-icon fas fa-share-alt"></i> [[Sharing]]</a>
						 	#end
					 	#end
					 	#if( $canaddnewcollection || $cancopycollection)
								<a class="dropdown-item emdialog" href="$siteroot$apphome/views/modules/librarycollection/copycollection.html?collectionid=$!librarycol.getId()" title="[[Create a copy of this Album]]"><i class="dropdown-item-icon fas fa-copy"></i> [[Copy Album]]</a>
						#end
						#if($caneditcollection)
						  #set( $link = "$siteroot$apphome/views/modules/librarycollection/share.html?collectionid=${librarycol.getId()}")
						  <a class="dropdown-item emdialog" id="sharetab" href="$link" data-hidefooter="true" title="[[Notifications]]"><i class="dropdown-item-icon fas fa-flag"></i> [[Notifications]]</a>
						  #set( $link = "$siteroot$apphome/views/modules/librarycollection/users.html?collectionid=${librarycol.getId()}")
						  <a class="dropdown-item emdialog"  id="editingtab"  href="$link" data-hidefooter="true" title="[[Editing Users]]"><i class="dropdown-item-icon fas fa-user-friends"></i> [[Editing Users]]</a>
						   #set( $link = "$siteroot$apphome/views/modules/librarycollection/permissions.html?collectionid=${librarycol.getId()}")
						  <a class="dropdown-item emdialog" id="permissionstab" href="$link" data-hidefooter="true" title="[[Viewing Users]]"><i class="dropdown-item-icon fas fa-user-check"></i> [[Viewing Users]]</a>
						  #set( $link = "$siteroot$apphome/views/modules/librarycollection/datapermissions/index.html?collectionid=${librarycol.getId()}&id=${librarycol.getId()}")
						  <a class="dropdown-item emdialog" id="colpermissionstab" href="$link" data-hidefooter="true" title="[[Album Permissions]] (${librarycol})"><i class="dropdown-item-icon fas fa-user-lock"></i> [[Album Permissions]]</a>
			              #if($librarycol.get('library'))
							  #set( $link = "$siteroot$apphome/views/modules/library/datapermissions/index.html?id=${librarycol.get('library')}")
							  <a class="dropdown-item emdialog" id="libpermissionstab" href="$link" data-hidefooter="true" title="$librarycol.library [[Library Permissions]]"><i class="dropdown-item-icon fas fa-user-lock"></i>  [[Library Permissions]]</a>
						  #end
						  #set( $editlink = "$siteroot$apphome/views/modules/librarycollection/edit/settings.html?collectionid=${librarycol.getId()}")
					 	  <a class="dropdown-item emdialog"  data-allwaysloadpage="true" data-hidefooter="true"   href="$editlink" title="[[AlbumProperties]]"><i class="dropdown-item-icon fas fa-cogs"></i> [[Properties]]</a>
					   	#else
						   	#set( $editlink = "$siteroot$apphome/views/modules/librarycollection/edit/settings.html?collectionid=${librarycol.getId()}")
						 	<a class="dropdown-item emdialog"  data-allwaysloadpage="true" data-hidefooter="true"   href="$editlink" title="[[Album Properties]]"><i class="dropdown-item-icon fas fa-cogs"></i> [[Properties]]</a>
						#end
					</div>
					</li>
				#end
			
				$pages.include("$componenthome/results/selected/index.html",$context)
	
				#if( $enabled && ($canpublish || $canemaillink || $canexportdata ) )
				  <li class=" dropdown">
					<a class=" dropdown-toggle" href="#" id="navbarSharehDropdown" role="button" data-toggle="dropdown"  data-bs-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false">[[Share]]</a>
						<div class="dropdown-menu" aria-labelledby="navbarShareDropdown">
							#if($canpublish || $canemaillink )				
									#if( $canemaillink )
										<a class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/emailassets.html?hitssessionid=$!hits.getSessionId()" >[[Email Assets]]</a>
									#end
									#if( $canpublish)
										<a  class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/publishassets.html?hitssessionid=$!hits.getSessionId()" >[[Publish Assets to Server]]</a>
									#end
									#if( $canquickgallery)
										<a  class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/creategallerycollection.html?hitssessionid=$!hits.getSessionId()" >[[Create a shareable gallery]]</a>
									#end
							#end
							#if($canexportdata)
								<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&searchtype=asset">[[Export results]]</a>
								<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&friendly=true&searchtype=asset&view=asset/resultstable">[[Export results (friendly)]]</a>
							#end		
						</div>
					</li>
				#end
			
				#if($enabled && $canquickpublish )
					#set($quickpublishlist = $mediaarchive.getList("quickpublish"))
					<li class="">
						<a class="" href="#" id="navbarPublishDropdown" role="button" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">[[Publish]]</a>
							<div class="dropdown-menu" aria-labelledby="navbarPublishDropdown">
								#foreach($item in $quickpublishlist)
									<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/activity/publish/quickpublish.html?hitssessionid=$!hits.getSessionId()&quickid=$item.id"   >$item.name</a>
								#end
							</div>
						</li>
				#end
	  			#set( $edit = $context.getRequestParameter("editheader") )
			
				#if ( $cancheckout && $order)
					<li>
						<a class="updatebasket emdialog -cart" data-action="remove" targetdiv="basket-paint"  href="$siteroot$apphome/views/modules/asset/activity/checkout/accept.html?orderid=${order.id}" title="[[Checkout your Cart]]">[[Checkout Cart]] <i class="fas fa-caret-right"></i></a>
					</li>				
				#end
			#end
			
			#if($desktop && $user && ($candownload || $canconvert || $candownloadfpo ) )
				$pages.include("$componenthome/desktop/menu.html?collectionid=$librarycol.getId()",$context)
			#end
			
			#if($topmoduleid != "favorites")
			<li class="navbarfilter">
			<a href="$applink/views/modules/asset/components/filters/dialog.html"
				class="emdialog"
				data-dialogid="entityfilters"
				data-hidebackdrop="true"
				data-hidefooter="true"
				data-modalsize="sm"
				data-moduleid="asset"
				data-hitssessionid="$hits.getSessionId()"
				data-categoryid="$!categoryid"
				data-rootcategory="$!rootcategory"
				data-topmoduleid="$!topmoduleid"
				data-targetdivsearch="$!maintargetdiv"
				data-dialogresults="$!dialogresults"
				title="[[Add Search Filter]]"
				><i class="fas fa-search"></i> &nbsp;[[Filter Search]]</a>
			</li>
			#end
			<li id="filtersselected">
				$pages.include("$componenthome/filters/filters-inline.html", $context)
			</li>
			
			<li style="position:absolute; left: 45%;">
			<div id="resultsmessages"></div>
			</li>
				
			</ul>
			<ul class="resultsnavright">
				#if(!$resultview)
					#set($resultview = $userprofile.get("$!{searchtype}resultview"))
					#if (!$resultview)
						#set($resultview = $content.get("resultview"))
					#end
					#if (!$resultview)
						#set($resultview = "stackedgallery")
					#end
				#end
				
				$context.putPageValue("resultview", $resultview)
				
				
				#if(!$edit || $edit == "false"  )
				
					##-PAGINATION
				
					#set($total = $hits.getTotalPages() )
					#if( $total > 1)
						<li class="resultpages">		
							
							$pages.include("$componenthome/results/positions.html", $context)
						</li>
					#end
					
					
					##-HITSPERPAGE
					
					##if($resultview != "stackedgallery")
						#if($dialogresults)
							#set($targetdiv= "dialog$!{moduleid}resultscontainer")
						#else
							#set($targetdiv= "$!{moduleid}resultscontainer")
						#end
					
						<li class="resultsnavtitem" style="width:65px;">
								#set( $currenthitsperpage = $userprofile.get("${resultview}assethitsperpage"))
								
								#if(!$currenthitsperpage)
									#set( $currenthitsperpage = $userprofile.get("assethitsperpage"))
								#end
								#set($hitcountoptions = $mediaarchive.getList("hitcount"))
								<select class="form-control form-select-sm hitsperpagechange resultsnavselect" 
										id="hitsperpagechange$!topmodule"
										data-oemaxlevel="1">
									#foreach($ho in $hitcountoptions)
									<option value="$ho.id" #if($currenthitsperpage==$ho.id) selected="selected"#end>#text($ho)</option>
									#end	
								</select>
						</li>	
					##end	
					
					
					##-RESULTS TYPE
					
					<li class="resultsnavtitem">
						<select class="form-control" 
							name="resultview" 
							id="selectresultview">
							#set( $types = $mediaarchive.getList("resulttype"))
							#foreach($type in $types)
								<option value="$!type.getId()" #if( $resultview == "$type.getId()") selected #end>$type.getName($context)</option>
							#end
						</select>
						
					</li>
					
				#end	
				
				
				#if(!$resultview || $resultview == 'table')
					#if( $canedittablecolumns )
						#if( $edit )
							
							<li class="resultsnavtitem" style="min-width:180px">
								#set ($alldetails = $searcher.getUserPropertyDetails() )
								<span class="" style="padding-right: 10px;" >*[[Drag columns to move them]]</span>
								<select class="form-control form-control-sm select2 tableresultsaddcolumn" 
										name="addcolumn"
										data-componenthome="$!siteroot$componenthome/results/addremovecolumns.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true"
										data-targetdiv="$!module.getId()resultsarea" 
										data-oemaxlevel="1"
										data-allowclear="false" >
									<option>[[Add Column]]</option>
									#foreach( $detail in $alldetails) <option value="$!detail.id">$detail.getText($context)</option>
									#end
								</select>
								
							</li>
							<li>
								<a class="ajax table-edit-close" 
									data-targetdiv="$!module.getId()resultsarea"
									data-oemaxlevel="1" 
									title="[[Close Edit Columns Mode]]"
									href="$siteroot$componenthome/results/index.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader="><i class="fas fa-times"></i></a>
							</li>		
							<li class="resultsnavtitem">
								
							</li>
						#else 
							<li >
								<a class="ajax nav-hover" 
									id="table-editor" 
									data-targetdiv="$!module.getId()resultsarea"
									data-oemaxlevel="1" 
									href="$siteroot$componenthome/results/index.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true">
									<i class="fas fa-edit"></i></a>
							</li>
						#end	
					#end								
				#end
		
				
		</ul>
		
	</div>
	<div class="clearfix"></div>
	</div>
