#if( !$hits )
	#set( $hits = $collectionassets)
	$context.putPageValue("hits",$hits)
#end

#if( !$hits )
	#set( $hits = $orderassets)
	$context.putPageValue("hits", $hits)
#end

#if($hits)
	#if(!$searchtype)
		#set ( $searchtype = $context.getRequestParameter("searchtype") )
	#end
	#if(!$searchtype)
		#set ( $searchtype = "asset" )
	#end
	#if(!$ismodulesearch)
		#set ( $ismodulesearch = $content.get("ismodulesearch") )
	#end
	#if(!$ismodulesearch)
		#set ( $ismodulesearch = $context.getRequestParameter("ismodulesearch") )
	#end
	
	#set( $categoryid = $hits.getInput("categoryid") )
	#if (!$categoryid)
		#set( $categoryid = $context.getRequestParameter("category"))
	#end
	#set( $nodeID = $context.getRequestParameter("nodeID"))
	#if (!$categoryid && $nodeID)
		#set( $categoryid = $nodeID )
	#end
	#if ($categoryid)
		$context.putPageValue("catid",$categoryid)  ##used?
		$context.putPageValue("categoryid",$categoryid)
	#end
	#if( $categoryid && !$category)
		#set( $category = $mediaarchive.getData("category",$categoryid) )
	#end
	#set( $orderid = $hits.getInput("orderid") )
	#if( $orderid )
		#set( $order = $mediaarchive.getData("order",$orderid) )
		$context.putPageValue("order",$order)
	#end
	
	#if( !$librarycol && $category ) 
		#set( $librarycol = $mediaarchive.query("librarycollection").orgroup("rootcategory",$category.getParentCategories()).searchOne() )
	#end

	#if( $librarycol )	
		$context.putPageValue("librarycol",$librarycol)
	#end
#end


<div id="resultsheader">

<div id="sub-nav" class="emsubnav sub-nav-${module.id}">
	<ul class="resultsnav">
		#set ($enabled = false)
		#if ($hits.getSelectionSize() && $hits.getSelectionSize()>0)
			#set ($enabled = true)
		#end
		
		##if( $librarycol )
		##	$pages.include("$componenthome/desktop/menu.html?collectionid=$librarycol.getId()", $context)				
		##end

		#if ($resultview != "map")
			$pages.include("$componenthome/results/selected/index.html",$context)

			#if( $enabled && ($canpublish || $canemaillink || $canexportdata ) )
			  <li class=" dropdown">
				<a class=" dropdown-toggle" href="#" id="navbarSharehDropdown" role="button" data-toggle="dropdown" 
					aria-haspopup="true" aria-expanded="false">[[Share]]</a>
					<div class="dropdown-menu" aria-labelledby="navbarShareDropdown">
						#if($canpublish || $canemaillink )				
								#if( $canemaillink )
									<a class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/emailassets.html?hitssessionid=$!hits.getSessionId()" >[[Email Assets]]</a>
								#end
								#if( $canpublish)
									<a  class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/publishassets.html?hitssessionid=$!hits.getSessionId()" >[[Publish Assets to Server]]</a>
								#end
								#if( $canquickgallery)
									<a  class="dropdown-item emdialog" data-hidefooter="true" href="$siteroot$apphome/views/modules/asset/activity/creategallerycollection.html?hitssessionid=$!hits.getSessionId()" >[[Create a shareable gallery]]</a>
								#end
						#end
						#if($canexportdata)
							<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&searchtype=asset">[[Export results]]</a>
							<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&friendly=true&searchtype=asset&view=asset/resultstable">[[Export results (friendly)]]</a>
						#end		
					</div>
				</li>
			#end
		
			#if($enabled && $canquickpublish )
				#set($quickpublishlist = $mediaarchive.getList("quickpublish"))
				<li class="">
					<a class="" href="#" id="navbarPublishDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">[[Publish]]</a>
						<div class="dropdown-menu" aria-labelledby="navbarPublishDropdown">
							#foreach($item in $quickpublishlist)
								<a class="dropdown-item" href="$siteroot$apphome/views/modules/asset/activity/publish/quickpublish.html?hitssessionid=$!hits.getSessionId()&quickid=$item.id"   >$item.name</a>
							#end
						</div>
					</li>
			#end
		
  			#set( $edit = $context.getRequestParameter("editheader") )
		
			#if ( $cancheckout && $order)
				<li>
					<a class="updatebasket emdialog -cart" data-action="remove" targetdiv="basket-paint"  href="$siteroot$apphome/views/modules/asset/activity/checkout/accept.html?orderid=${order.id}" title="[[Checkout your Cart]]">[[Checkout Cart]] <i class="fas fa-caret-right"></i></a>
				</li>				
			#end
		#end
		

			
		</ul>
		<ul class="resultsnavright">
			#if(!$resultview)
				#set($resultview = $userprofile.get("resultview"))
				#if (!$resultview)
					#set($resultview = $content.get("resultview"))
				#end
				#if (!$resultview)
					#set($resultview = "stackedgallery")
				#end
			#end
			
			
			#if (!$resultview || $resultview == 'table')
				#if( $canedittablecolumns )
					#if( $edit )
						<li>
							<a class="ajax table-edit-close" data-targetdiv="resultsdiv" href="$siteroot$componenthome/results/table.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader="><i class="fas fa-times"></i></a>
						</li>
						<li class="resultsnavtitem" style="min-width:180px">
							#set ($alldetails = $searcher.getUserPropertyDetails() )
							<select class="form-control form-control-sm select2 tableresultsaddcolumn" 
									name="addcolumn"
									data-componenthome="$siteroot$componenthome/results/addremovecolumns.html?oemaxlevel=1&searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true"
									data-targetdiv="resultsdiv" 
									data-allowclear="false" >
								<option>[[Add Column]]</option>
								#foreach( $detail in $alldetails) <option value="$detail.id">$detail.getText($context)</option>
								#end
							</select>
						</li>
								
						<li class="resultsnavtitem">
							<span class="" style="padding-right: 10px;" >[[Drag columns to move them]]</span>
						</li>
					#else 
						<li >
							<a class="ajax nav-hover" id="table-editor" data-targetdiv="resultsdiv" href="$siteroot$componenthome/results/table.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true"> <i class="fas fa-edit"></i></a>
						</li>
					#end	
				#end								
			#end
	
			#if(!$edit || $edit == "false"  )
				<li class="resultsnavtitem">
					<select class="form-control" 
						name="resultview" 
						id="selectresultview"  
						data-hitssessionid="$!hits.getSessionId()" 
						data-searchtype="$searchtype"
						data-ismodulesearch = "$!ismodulesearch" 
						data-componenthome = "$!componenthome"
						data-page="$!hits.getPage()" 
						data-showremoveselections="$showremoveselections" 
						data-collectionid="$!librarycol.getId()"
						data-targetdiv="applicationmaincontent">
						#set( $types = $mediaarchive.getList("resulttype"))
						#foreach($type in $types)
							<option value="$type.getId()" #if( $resultview == "$type.getId()") selected #end>$type.getName($context)</option>
						#end
					</select>
					
				</li>
				#if ($resultview != "map")
					#if( $hits.size() > 0)
						<li class="resultsnavtitem hidden-sm-xs hidden-xs hidden-sm hidden-md">
							$pages.include("$componenthome/results/pages.html",$context)
						</li>	
					#end
				#end
			#end	
	</ul>
	
</div>
<div class="clearfix"></div>
</div>

 