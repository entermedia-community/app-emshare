#ifnull($hits)
	#set($hits = $modulehits)
#end

#set($hitssessionid = $hits.getSessionId())
#set($moduleid = $module.id)
#if (!$nodeID)
	#set($nodeID = $context.getRequestParameter("nodeID"))
	$context.putPageValue("nodeID",$nodeID)
#end

#if( !$librarycol && $category ) 
	#set( $librarycol = $mediaarchive.query("librarycollection").orgroup("rootcategory",$category.getParentCategories()).searchOne() )
#end

#if( $librarycol )	
	$context.putPageValue("librarycol",$librarycol)
#end



#set($targetdiv = "assetresults") 

<div class="filteredinline">
#set($filtercount = 0)
	#set( $terms = $hits.getFilteredTerms($context,"advancedfilter") )
	#if(!$terms)
		##check modulehits
		#set( $terms = $modulehits.getFilteredTerms($context,"advancedfilter") )
	#end
	
	#foreach( $term in $terms)
		#if( $librarycol )
			#set($href = "$siteroot$apphome/views/modules/librarycollection/showcategory.html?hitssessionid=$!hits.getSessionId()&collectionid=$!librarycol.getId()&removeterm=$!term.getId()")
			#set($oemaxlevel = "3")
		#else
			#if($moduleid=="asset")
				#set($href = "$siteroot$apphome/views/modules/$moduleid/indexembed.html?hitssessionid=$!hits.getSessionId()&rootcategory=$!rootcategory&categoryid=$!{categoryid}&removeterm=$!term.getId()")
				#set($oemaxlevel = "1")
			#else
				#set($href = "$siteroot$apphome/views/modules/$moduleid/index.html?hitssessionid=$!hits.getSessionId()&removeterm=$!term.getId()")
				#set($oemaxlevel = "3")
			#end
		#end
		#if ($nodeID)
		 	#set($href = $href + "&nodeID=${nodeID}")
		#end
		#if($currentSort)
			#set($href = $href + "&sortby=${currentSort}")
		#end
	
		<a href="$href"
			class=" ajax"
			title="[[Clear]] $term.getDetail()"
			data-targetdiv="$targetdiv" 
			data-oemaxlevel="$oemaxlevel"
			data-updateurl="true" >$term.getDetail(): 
			#foreach( $val in $term.getValueCollection() )
				
			 	#if ($term.getDetail().getId() == "keywords")
					#if( $foreach.count > 1) [[and]] #end
				#else
					#if( $foreach.count > 1) [[or]] #end
				#end
				
				#if($term.getDetail().isList())
					#set($data = $mediaarchive.getCachedData($term.getDetail().getListId(),$val))
					$!context.getText( $data )
				#elseif($term.getDetail().isBoolean())
					#if($term.getValue() == "true")
						[[True]]
					#else
						[[False]]
					#end
				#elseif($term.getDetail().isDate())
					#set($op = $term.operation)
					#if($op == "afterdate")
						[[After]]:
					#elseif($op == "beforedate")
						[[Before]]:
					#elseif($op == "betweendates")
						[[Between]]:
					#end
					
		            $term.getValue()
				#else
		            #if($term.getValue())
		                $term.getValue()
		            #elseif($val)
		                $val
		            #end
				#end
			#end <i class="fas fa-times"></i></a>
			#set($filtercount = $filtercount+1)
	#end



	#if( $hits.getSearchQuery().hasMainInput() || ($terms && !$terms.isEmpty() && $terms.size()>1)  || $clearfiltershref)
		#if($clearfiltershref)
			#set($href = $clearfiltershref)
		#elseif( $librarycol )
			#set($href = "$siteroot$apphome/views/modules/librarycollection/showcategory.html?hitssessionid=$!hits.getSessionId()&collectionid=$!librarycol.getId()&assetclearresults=true&clearfilters=true")
			#set($oemaxlevel = "2")
		#else
			#if($moduleid=="modulesearch")
				#set($href = "$siteroot$apphome/index.html?hitssessionid=$!hits.getSessionId()&clearselection=true&clearfilters=true")
				#set($oemaxlevel = "3")
			#else
				#if($moduleid=="asset")
					#set($href = "$siteroot$apphome/views/modules/${moduleid}/indexembed.html?hitssessionid=$!hits.getSessionId()&assetclearresults=true&assetclearselection=true&clearselection=true&clearfilters=true")
					#set($oemaxlevel = "4")
				#else
					#set($href = "$siteroot$apphome/views/modules/${moduleid}/index.html?hitssessionid=$!hits.getSessionId()&${moduleid}clearresults=true&${moduleid}clearselection=true&clearselection=true&clearfilters=true")
					#set($oemaxlevel = "4")
				#end
			#end
		#end
		#if ($nodeID)
	 		#set($href = $href + "&nodeID=$!{nodeID}")
		#end
		<a class="clearallfilters ajax btn-clearall " 
			href="$href"
			data-targetdiv="$targetdiv" 
			data-oemaxlevel="$oemaxlevel" 
			data-updateurl="true" 
			data-onsuccess="closetypeaheadmodal"
			title="[[Clear Search Filters]]">[[Clear All Filters]] <i class="fas fa-times"></i> </a>
	#end
	
	<div class="clearfix"></div>

</div>


