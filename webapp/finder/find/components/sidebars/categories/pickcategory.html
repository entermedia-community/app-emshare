##AssetPicker Media Viewer


#if (!$treename)
	#set( $treename = "MainTree" )
#end
#set( $action = $context.getRequestParameter("pickedcategoryaction") ) 

#if (!$targetdiv)
	#set( $targetdiv = $context.getRequestParameter("targetdiv") )
#end

$context.putPageValue("targetdiv",$targetdiv)

#set( $detailid = $context.getRequestParameter("detailid") )
#if(!$detailid)
	#set( $detailid = "category") 
#end

#set( $pickone = $context.getRequestParameter("pickone") )
#if (!$pickone)
	#set( $pickone = false )
#end
#set( $categories = $context.getRequestParameter("${detailid}.value") )
#if(!$categories)
	#set( $categories = $context.getRequestParameter("category-exact.values") )
#end	
#if(!$categories)
	#set( $categories = $context.getRequestParameter("category.values") )
#end
#if(!$categories)
	#set( $categories = $context.getRequestParameter("category-exact.values") )
#end	
#if(!$categories)
	#set( $categories = $context.getRequestParameter("existingcategories") )
#end

#if(!$categories)
	#set( $categories = $context.getRequestParameter("nodeID") )
#end

#if(!$categories && $category)
	#set( $categories = $category.getId() )
#end



#set( $multivalue = $context.getRequestParameter("multivalue") )
#if($multivalue != "true")
	$context.putPageValue("selectedcategories",$categories)
	#set($category = $mediaarchive.getCategory($categories))
	#ifnotnull($category)
		#set($initialcategory = $category.getId())
	#end
	#if(!$initialcategory)
		#set($initialcategory = "index")
	#end
#end

#set( $assetid = $context.getRequestParameter("assetid") )

#if($canviewupload || $canviewcategoryupload)
	#set($canupload = true)
#end
$context.putPageValue("canupload", $!canupload)
		
<div class="pickcategoriesdialog">
	<div class="searchcategories-tree">
	    <div class="assetdropcategory assetdropcategorymove searchcategories-treecontainer categorytreescrolllable" >
	       	
	        	#set( $link = "$apphome/components/emtree/tree.html")
	        	#set( $link = "${link}?treename=$treename&editabletree=false&clearselection=$!clearselection&updateAddressBar=false&hidecontextmenu=true" )
	        	#set( $link = "${link}&oemaxlevel=4&uploadmaxlevel=2&maxlevelclick=$!maxlevelclick" )
	        	#set($link = "$link&targetdivinner=pickcategorycontent&urlprefix=$apphome/sidebars/categories/searchcategoryfilter.html")
	        	
	        	$context.putPageValue("canupload", false)
	
			$pages.include($link, $context)  
		</div>
	</div>
	<div class="searchcategories-filter flex-grow-1">
		<div id="pickcategorycontent" class="searchcategories-results"> 
		$pages.include("$apphome/sidebars/categories/searchcategoryfilter.html?nodeID=$!initialcategory",$context)
		</div>
	</div>
</div>
	
