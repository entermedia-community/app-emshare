#if(!$moduleid)
	#set( $moduleid = $module.getId())
#end
#set($preferencename = "${moduleid}summary")
#set($preference = '#set($selectedpreference = ' + '$!userprofile.minimize'  + $preferencename + ')')
#evaluate($preference)
#ifnull($selectedpreference)
	#set($selectedpreference = "false")
#end
<div class="summary-container #if($selectedpreference == "false") closed#end">
	<div class="d-flex align-items-center justify-content-between">
		<div class="summary-header summary-toggler" data-target="$preferencename">
			<h3>[[Summary]]</h3>
			<button class="btn">
				<i class="fas fa-angle-double-right"></i>
			</button>
		</div>
	</div>
	<div class="p-1" style="border-left:1px solid #e5e5e5;height:100%">
		<div class="col-sidebar-scroll">
		#if($module.getId()=="modulesearch")
			$pages.include("$apphome/components/gridfilters/index.html", $context)
		#else
			$pages.include("$componenthome/filters/index.html", $context)
		#end

		## ENTITIES
		#if($canviewentitiesbreadcrumb)
			#set( $entities = $userprofile.getEntitiesInParent($category) )
			#if($entities && $entities.size() > 0)
				<div class="filter-box">
					<div class="filter-box-header">
						<div class="d-flex align-items-center toggle-filter sidetoggle flex-grow-1" data-target="searchfilterboxrelatedentity">
							<span class="mr-2">
								<i class="caret fas fa-caret-right exp"></i>
							</span> 
							<p class="m-0 flex-grow-1">[[Related Entity]]</p>
						</div>
					</div>
					<div class="filter-box-options" id="searchfilterboxrelatedentity">
						<div class="category-entities-actions">
						#foreach ( $data in $entities)
							#set($entity = $data.getData())
							#set($entityid = $data.getId())
							#set($emoduleid = $data.getModuleId()) 
							
							#set($emodule = $mediaarchive.getData("module", $emoduleid))
							
							#set($rendertype = $emodule.modulerendertype)
							#if (!$rendertype)
								#set($rendertype = "entity")
							#end
							$context.putPageValue("rendertype", $rendertype)
							$context.putPageValue("rendermoduleid", $emoduleid)
							
							#set($moduleicon = "entity")
							#if ($emodule.moduleicon)
								#set($moduleicon = $emodule.moduleicon)
							#end
								
							#set($previewurl = "$!{siteroot}$apphome/views/modules/$!{emoduleid}/components/gridsample/preview/${rendertype}.html?id=$entity.getId()&hitssessionid=$!hits.sessionId")
							
							$context.putPageValue("hit", $entity)
							
							#set($moduleicon = "entity")
							#if ($module.moduleicon)
								#set($moduleicon = $module.moduleicon)
							#end
							
							<div class="category-entity">    	
								<a href="$previewurl" 
								class="emdialog entity-dialog emgridresulttitle " 
								data-hidefooter="true" 
								data-hideheader="true"
								id="clickid${entityid}"  
								data-id="${entityid}"
								data-moduleid="$!emoduleid"
								title="#text($!entity)">
								<i class="fas fa-folder"></i>&nbsp;#text($emodule) \ #text($entity)</a>
							</div>
						#end
						</div>
					</div>
				</div>
			#end
		#end
		</div>
	</div>
</div>