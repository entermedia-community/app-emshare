#set($entityid = $context.getRequestParameter("entityid"))
#if( !$entity)
	#set( $entity  = $mediaarchive.getData($parentsearchtype, $entityid) )
#end
#set($entityid = $entity.id)
#if(!$currenttab)
	#set($currenttab = $context.getRequestParameter("currenttab"))
#end
#if(!$topmoduleid)
	#set ( $topmoduleid = $context.getRequestParameter("topmoduleid") )
	$context.putPageValue("topmoduleid", $topmoduleid)
#end
#ifnotnull($topmoduleid)
	#set($topmodule = $mediaarchive.getCachedData("module", $topmoduleid))
#end
#ifnull($viewid)
#set($viewid = $context.getRequestParameter("viewid"))
#end
#ifnull($viewid)
	#set($viewid = $context.getRequestParameter("parentviewid"))
#end
#set($tabid = "tab_$viewid")


<div id="${tabid}" 
class=" entity-tab-content entity-tab-media tabtypemedia" 
data-tabid="${tabid}"
data-viewid="$viewid"
data-entityid="$!entityid"
data-currenttab="$!viewid"
data-topmoduleid="$!topmoduleid"
data-url="$componenthome/gridsample/preview/tabpublishing.html"
>

<div id="publishingcontainer" class="tabpulications" style="height: 100%;">
	<div class="tabpulications-col" style="padding:10px 20px;  flex: 0 0 500px;">
	
	<form action="$componenthome/gridsample/preview/tabpublishingsave.html" class="ajaxform" data-targetdiv="${tabid}">
		<div class="form-group">
			<div class="form-check form-check-inline">
			  <input type="hidden" value="title_enabled" name="field" />
			  <input class="form-check-input" type="checkbox" id="titlelabel" value="true" name="title_enabled.value" #if($publishing.title_enabled=="true")checked#end>
			  <label class="form-check-label" for="titlelabel">[[Title]]</label>
			</div>
			<input type="hidden" value="title" name="field" />
		    <input  class="form-control"  placeholder="[[Enter Title here]]" name="title.value" value="$!publishing.title">
		 </div>
		 
		 <div class="form-group">
			<div class="form-check form-check-inline">
				<input type="hidden" value="footer_enabled" name="field" />
			  <input class="form-check-input" type="checkbox" id="footerlabel" value="true" name="footer_enabled.value"  #if($publishing.footer_enabled=="true")checked#end>
			  <label class="form-check-label" for="footerlabel">[[Footer]]</label>
			</div>
			<input type="hidden" value="footer" name="field" />
		    <input  class="form-control"  placeholder="[[Enter Footer here]]" name="footer.value" value="$!publishing.footer">
		 </div>
		 
		 <div class="form-group">
			<div class="form-check form-check-inline">
				<input type="hidden" value="caption_enabled" name="field" />
			  <input class="form-check-input" type="checkbox" id="captionlabel" value="true" name="caption_enabled.value" #if($publishing.caption_enabled=="true")checked#end>
			  <label class="form-check-label" for="captionlabel">[[Caption]]</label>
			</div>
			<input type="hidden" value="caption" name="field" />
		    <textarea  class="form-control"   name="caption.value">$!publishing.caption</textarea>
		 </div>
		
		
		<div class="form-group">
			<div class="form-check form-check-inline">
				<input type="hidden" value="enabled" name="field" />
			  <input class="form-check-input" type="checkbox" id="enabledlabel" value="true" name="enabled.value" #if($publishing.enabled=="true")checked#end>
			  <label class="form-check-label" for="enabledlabel">[[Enabled]]</label>
			</div>
		    
		 </div>
		<input type="hidden" value="entityid" name="field" />
		<input type="hidden" name="entityid.value" value="$!entityid" />
		#if($publishing)
			<input type="hidden" name="publishingid" value="$!publishing.id" />
			<input type="hidden" name="id.value" value="$!publishing.id" />
		#end
		
		<input type="hidden" name="searchtype" value="distributiongallery" />
		<input type="hidden" name="field" value="moduleid" />
		<input type="hidden" name="moduleid.value" value="$!topmoduleid" />
		<input type="hidden" name="topmoduleid" value="$!topmoduleid" />
		<input type="hidden" name="parentviewid" value="$!viewid" />
		<input type="hidden" name="entityid" value="$!entityid" />
		<input name="save" type="hidden" value="true">
		
		<input type="submit" value="[[Save]]" class="btn btn-sm btn-primary"> 
		
		#if($publishing.enabled=="true")
			<a href="/$mediadbappid/services/publishingdestination/preview.html?publishingid=${publishing.id}" class="btn btn-sm btn-secondary" style="margin-left: 10px;;">[[Preview]]</a>
		#end
	</form>
</div>


<div class="tabpulications-col" style="height: 100%;">
	<div style="background-color: #fff; padding: 20px; height: 100%;  overflow-y: auto;">
	<div style="text-align: center; padding: 2em; border: 2px solid #333; border-radius: 10px; background-color:rgb(158, 255, 225);">
		#set($title = "[[Title]]")
		#if($publishing.title_enabled=="true" && $publishing.title)
			#set($title = $publishing.title)
		#end
		<h3 style="margin:0;">$title</h3>
		</div>
		#set($caption = "[[Caption Text]]")
		#if($publishing.caption_enabled=="true" && $publishing.caption)
			#set($caption = $publishing.caption)	
		#end
	<div style="padding:2em;text-align: center; ">$!caption</div>
	
	
		#ifnull($defaultfolder)
			#ifnull($entity)
				#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))
			#end
			
			#ifnotnull($entity)
				#if($topmodule.getId()=="faceprofilegroup")
					#set($defaultfolder =  $mediaarchive.getBean("entityManager").loadDefaultFolderForModule($topmodule, $context.getUser()))		
				#else
					#set($defaultfolder =  $mediaarchive.getBean("entityManager").createDefaultFolder($entity, $context.getUser()))
				#end
			#end
		#end
		$context.putPageValue("defaultfolder", $defaultfolder)
		#if(!$currentcategoryid && $defaultfolder)
			#set( $currentcategoryid = $defaultfolder.getId())
			$context.putPageValue("categoryid", $currentcategoryid)
		#end
		
		$context.putPageValue("entitydialogid", "entitypublishing")
		$pages.include("$apphome/views/modules/asset/publishing/index.html", $context)
	
	
		#set($footer = "[[Footer]]")
		#if($publishing.footer_enabled=="true" && $publishing.footer)
			#set($footer = $publishing.footer)
		#end
	<div style="padding:0.5em; font-size: 0.9em;; margin:2em; text-align: center; border-top:2px solid #666;">$!footer</div>
	</div>
</div>
</div>


</div>


