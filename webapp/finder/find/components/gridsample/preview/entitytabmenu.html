##always reset it?

#if($tabmodule)
	#set( $searchtype = $tabmodule.getId())
	#set( $moduleid = $tabmodule.getId())
#end
#ifnull($id)
	#set( $id = $context.getRequestParameter("id"))
#end
#ifnull($id)
	#set( $id = $context.getRequestParameter("entityid"))
#end
#if(!$tabtype)
	#set($tabtype = $context.getRequestParamenter("tabtype"))
#end
#if($tabtype == "submodulehome")
	#set($tabid = "tab_${viewid}")
	#set($tabname = $viewdata.getName($context))
#elseif($tabtype=="media")
	#set($tabid = "tab_media")
	#set($tabname = $tabmodule.getName($context))
#else
	#if( !$entity)
		#set( $entity  = $mediaarchive.getData($searchtype, $id) )
	#end
	#set($tabname = $viewdata.getName($context))
	#set($targetentitytabid = "entity-tab-#eid($!{viewid})")
	#set($tabid = "tab_$viewid")
#end

<div class="entity-tab  #if($currenttab == $tabid) current-entity #end" #if(!$tabtype) data-entityid="$!entity.getId() #end">
	<a 
		#if($addnew=='true')
			href="#"
		#else
			href="#$!tabid"
		#end 
		class="entity-tab-label"
		id="tab_$!tabid"
		data-tabid="$!tabid"
		data-currenttab="$!tabid"
		data-tabtype="$!tabtype" 
		data-toggle="tab"
		data-target="$!targetentitytabid"
		data-topmoduleid="$!topmoduleid"
		data-moduleid="$!moduleid"
		#if($id.startsWith("multiedit"))
			data-ismultiedit="true"
			data-edit="true"
		#end 
		role="tab" 
		#if(!$tabtype)
			aria-controls="$targetentitytabid" 
			data-entityid="$!entity.getId()"
		#end 
		title="#esc($tabname)">
		
	   	#if (!$moduleicon && $tabmodule.moduleicon)
	   		#set($moduleicon = $tabmodule.moduleicon)
	   	#end

		#set($$defaultIcons = {})
		$!$defaultIcons.put("media", "file-earmark-text")
		$!$defaultIcons.put("back", "card-list")
		$!$defaultIcons.put("data", "card-list")
		$!$defaultIcons.put("activities", "calendar3")
		$!$defaultIcons.put("collaboration", "diagram-3")
		$!$defaultIcons.put("person", "person-bounding-box")
		$!$defaultIcons.put("people", "people")
		$!$defaultIcons.put("location", "geo-alt")
		$!$defaultIcons.put("tv", "display")
		$!$defaultIcons.put("programs", "cast")
		$!$defaultIcons.put("playbutton", "play")
		$!$defaultIcons.put("category", "card-checklist")
		$!$defaultIcons.put("event", "calendar-plus")
		$!$defaultIcons.put("product", "cart")
		$!$defaultIcons.put("company", "building")
		$!$defaultIcons.put("project", "table")
		$!$defaultIcons.put("entity", "boxes")
		$!$defaultIcons.put("season", "calendar2")

		#set($moduleicon = $!$defaultIcons.get($moduleicon))
		#ifnull($moduleicon)
			#set($moduleicon = "box")
		#end

		<i class="bi bi-$moduleicon module-icon"></i> 
		
		#if($tabtype == "submodulehome")
			#text($tabname)
		#elseif($tabtype=="media") 
			 #text($tabmodule)
		#else
			#text($tabname)
		#end
	</a>
</div>




