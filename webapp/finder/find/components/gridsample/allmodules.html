#set($section = $content.get("section"))
#set($filter = $modulehits.findFilterValue("entitysourcetype") )
$context.putPageValue("filter", $filter)

#if( $organizedModules.isEmpty())
	<div>0 [[results]]</div>
#end

$context.putPageValue("ismodulesearch","true")

#set( $expandedmodule = $mediaarchive.getCatalogSettingValue("defaultmodule") )

#if($module.id != "modulesearch" && $expandedmodule && $organizedHits.containsKey($expandedmodule))
	#set($module = $mediaarchive.getCachedData("module",$expandedmodule))
		
	#set($idhits = $organizedHits.get($module.id))
	
	$context.putPageValue("hits", $idhits)
	$context.putPageValue("module", $module)
	$context.putPageValue("moduleid", $module.id)
	
	$pages.include("$apphome/components/gridsample/moduleexpanded.html", $context)
	
#end
<div class="modulesearchmodules"> 
#foreach($module in $organizedModules)
	#if($module.id != $expandedmodule)
		#set($idhits = $organizedHits.get($module.id))
		
		$context.putPageValue("hits", $idhits)
		$context.putPageValue("module", $module)
		$context.putPageValue("moduleid", $module.id)
		
	   	#set($modulerendertype = "entity")
	   	#if ($module.homepagerendertype)
	   		#set($modulerendertype = $module.homepagerendertype)
	   	#end
	   	
	   	$context.putPageValue("modulerendertype", $modulerendertype)
	  	
	   	#set( $favorites = $userprofile.get("favorites_"+$module.id))
		$context.putPageValue("favorites", $favorites)

		$pages.include("$apphome/components/gridsample/modulegrid.html", $context)
	#end 
#end
</div>
