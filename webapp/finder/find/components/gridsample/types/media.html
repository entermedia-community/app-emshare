<div class="masonry-grid" 
data-maxheightX="$!mediaarchive.getCatalogSettingValue('stacked_gallery_imagesize')"
data-maxheight="140" 
data-cellpadding="4"  >

#set($count = 0)
#set( $viewerlink = $content.get("assetviewerlink") )

#foreach( $hit in $hits)
	
	$context.putPageValue("hit", $hit)
	#set($type = $hit.getSearchHit().getType())
	#set( $rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))
	$context.putPageValue("type", $rendertype)
	
	   $context.putPageValue("assetid", $hit.id)
       $context.putPageValue("count", $count )
       $context.putPageValue("sourcepath", $hit.sourcepath )
       $context.putPageValue("thumbsize", "mediumplus" )
       
       #set($sourcepath = $hit.sourcepath)
       #set($assetwidth = $mediaarchive.getRealImageWidth($hit))
       #set($assetheight = $mediaarchive.getRealImageHeight($hit))
       #set($click = "$home$viewerlink?hitssessionid=${hits.getSessionId()}&assetid=${hit.id}")
       
	<div class="masonry-grid-cell stackedplayer-cell assetdraggable resultsassetcontainer" 
		 id="gallerycell_${hit.id}"
		 data-assetid="$hit.id" 
		 data-width="$assetwidth" 
		 data-height="$assetheight">
	    	<a class="stackedplayer imagearea " id="clickid${hit.id}" data-assetid="$hit.id" href="#">
	    	    <div class="grid-thumbimage" data-assetid="$hit.id">
	    	    	#if(!$rendertype || $type =="rendertype")
	    	    		#set( $rendertype = "mime" )
	    	    	#elseif( $rendertype =="video")
	    	    		#set( $rendertype = "videothumbnail" )
	    	    	#end
	    	    	
	        	    $pages.include("$componenthome/results/thumbnails/${rendertype}.html", $context)
	        	   	##$pages.include("$componenthome/results/badges.html", $context)
	        	</div>
	    	</a>
	      <div class="caption">
		      <div class="grid-gallery-checkbox resultsselection">
		          <input type="checkbox" class="selectionbox" name="count" value="" #if($hits.isSelectedOnPage(${hit.id})) checked #end data-dataid="${hit.id}" />          
		      </div>
	         
	         #set($stackedfield = $mediaarchive.getCatalogSettingValue("stackedgalleryfield"))
	         #if($stackedfield)
	         	#set($title = $hit.get($stackedfield))
			 #end
			 #if(!$title)		         	
	         	#if( $hit.assettitle )
		        	#set($title =  $hit.assettitle) #else #set($title = $hit.name) 
		        #end
	         #end

	         <div class="stacked-field-info" title="$title" ><a class="stackedplayer" href="#"  data-assetid="$hit.id">$title</a></div>
	     </div>
	</div>
       #set ( $count = $count + 1) 
    
	#end

</div>