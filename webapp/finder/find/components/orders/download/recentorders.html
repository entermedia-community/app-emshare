
#set( $downloadorders = $ordermanager.findDownloadOrdersForUser( $context,  $user))




<div class="sidebarorders overflow-y">
	#foreach($downloadorder in $downloadorders)

		#set($assetid = $downloadorder.getCurrentItem().get("assetid"))
		#set($asset = $mediaarchive.getAsset($assetid))
		#set($publishstatus = $downloadorder.getCurrentItem().get("publishstatus"))

		<div class="sidebarorder d-block py-2 px-2 $publishstatus">

			#set( $order = $downloadorder.getOrder())
			#set($downloadPercentage = $downloadorder.percentage() )

			<div class="downloadProgress d-${order.id}" style="display:#if($downloadPercentage==1) block #else none #end;width:$downloadPercentage%">
				<div class="shine" style="display:#if($downloadPercentage<1) block #else none #end;"></div>
			</div>

			<div class="d-flex align-items-center">
				#set ($mime = $mediaarchive.getMimeTypeIcon($asset.fileformat))
				#set( $thumbpath =  "$themeprefix/images/mimetypes/${mime}.png" )
				
				<img class="format-thumb" src="$!cdn$siteroot$thumbpath" />
			
				<div class="d-flex align-items-center justify-content-between flex-grow-1">
					<div class="d-flex flex-column flex-grow-1">
						<div class="order-name">
							$downloadorder.getCurrentItem().get("itemexportname")
						</div>
						<div class="order-filetype">
							#if( $downloadorder.getItemCount() > 1 )
								Zip File
							#else
								Image File
							#end
						</div>
						<div class="d-flex align-items-center justify-content-between">
							#set( $order = $!context.getAge($downloadorder.getEstimatedEndDate()))
							#ifnotnull($order)
								<span class="date">
									$!context.getAge($downloadorder.getEstimatedEndDate())
								</span>
							#end
							<span class="status">$order.orderstatus</span>
							<span class="file-size">2.3 GB</span>
						</div>
					</div>
				</div>
				<div class="file-thumb">
					#if($publishstatus == "complete" )
						<i class="bi bi-check-circle-fill success"></i>
					#elseif($order.orderstatus == "processing" ) 
						<i class="bi bi-hourglass-split processing"></i>
					#end
					#if($downloadorder.getCurrentItem().get("status") == "error")
						<i class="bi bi-x-circle-fill error"></i>
					#end
					<img src="https://picsum.photos/300/200" alt="">
				</div>
				<div class="actions">
					#if( $downloadorder.getItemCount() > 1 )
						<a href="#">
							<i class="bi bi-card-list"></i>
						</a>
					#end 
					#if($publishstatus == "readytopublish" )
						<a href="#" title="[[Download Again]]">
							<i class="bi bi-download"></i>
						</a>
					#end
					#if($publishstatus == "complete" )
						<a href="#" title="[[Downloading]]">
							<i class="fas fa-check-circle"></i>
						</a>
					#end
					#if($publishstatus== "readytopublish" || $publishstatus == "new" )
						<a href="#">
							<i class="bi bi-x-circle"></i>
						</a>
					#end
				</div>
			</div>
		</div>
	#end
</div>