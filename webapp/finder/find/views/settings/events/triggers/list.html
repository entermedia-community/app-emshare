<div id="eventlist" class="settigs-eventlist">
#set( $seltype = $context.getRequestParameter("type"))
#ifnotnull($seltype)
	$userprofile.setProperty("settings_last_event",$seltype)
#end
#ifnull($seltype)
	#set( $seltype  = $userprofile.settings_last_event)
#end


<div class="tab-actions clearfix">
	<select name="type" class="eventsjump form-control form-control-sm" 
			data-eventurl="$siteroot$apphome/views/settings/events/triggers/list.html"
			data-targetdiv="eventlist">
			<option value=""></option>
		#foreach( $event in $pathevents )
				#if( $type != $event.getPage().getDirectoryName() )
					#set( $type = $event.getPage().getDirectoryName())
					<option #if( $seltype == $type) selected #end value="$type">$type</option>
				#end
			#end
	</select>
	<strong style="margin-left: 5px;">[[Select a group of triggers to display]]</strong>
	 <a class="btn btn-sm btn-primary float-right ajax" style="margin-left: 5px;" 
	 	href="$siteroot$apphome/views/settings/events/triggers/edit/edit.html?new=true"
	 	data-targetdivinner="applicationmaincontent" data-oemaxlevel="3">[[New Event]]</a>
	  <a class="btn btn-sm btn-danger float-right ajax" style="margin-left: 5px;" 
	  	href="$siteroot$apphome/views/settings/events/triggers/reload.html"
	  	data-targetdivinner="applicationmaincontent" data-oemaxlevel="3">[[Stop Events]]</a>
	 
</div>

#ifnotnull($seltype)
<div class="emselectable">
	<table class="table table-striped table-hover emdata">
		<thead>
			<tr class="tableheader">
				<th>[[Name]]</th>
				<th>[[URL]]</th>
				<th>[[Activity]]</th>
				<th>[[Status]]</th>
			</tr>
		</thead>
		#foreach( $event in $pathevents )
		#if( $seltype == $event.getPage().getDirectoryName() )
		<tr rowid="$event.getPage().getPath()">
			<td>
				<p class="d-flex align-items-center m-0 fw-bold">
					#if( $event.isRunning() )
						<svg height="10" width="10" class="blinking">
							<circle cx="5" cy="5" r="5" fill="green" /> 
						</svg>&nbsp;
					#end
					$context.getText($event.getName())
				</p>
			</td>

			<td> 
				$event
				<div class="emselectabledetails">
					$!event.getPage().getProperty("eventdescription")
				</div>
			</td>

			<td>
				<p class="m-0 text-secondary">
					#if($event.getTotalRunCount() == 0)
						[[Never Ran]]
					#else
						<b>[[Last ran]]:</b> $!event.getFormattedLastRun()
						<br/>
						<b>[[Total Runs]]:</b> $event.getTotalRunCount()
					#end
				</p>
			</td>

			<td>
				<div class="d-flex flex-column small">
					#if( $event.getPeriod() > 0 )
						<span class="text-success mb-1">
							<i class="bi bi-arrow-repeat mr-2"></i>[[Repeating]]
						</span>
					#end
					#if(!$event.isEnabled())
						<span class="text-muted">
							<i class="bi bi-ban ns mr-2"></i>[[Disabled]]
						</span>
					#end 
				</div>
			</td>
		</tr>
		#end
		#end
	</table>
	<form name="showevent" method="post" 
			action="$siteroot$apphome/views/settings/events/triggers/edit/edit.html" 
			class="ajaxform" 
			data-targetdiv	="eventlist"
			data-oemaxlevel="1">
		<input name="eventpath" type="hidden" id="emselectedrow" />
	</form>
</div>
#end
</div>