	#set($asset = $mediaarchive.getAsset($hit.id))
	$context.putPageValue("asset", $asset)
	
	#set($click = "$siteroot$viewerlink?hitssessionid=${hits.getSessionId()}&assetid=${hit.id}")
	#set($isselected = $hits.isSelectedOnPage(${hit.id}) )
	
	#set($type = $hit.getSearchHit().getType())
	#set($rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))
	#if(!$rendertype || $type =="rendertype")
		#set( $rendertype = "mime" )
	#elseif( $rendertype =="video")
		#set( $rendertype = "videothumbnail" )
	#end
	
	#if( $hit.previewstatus == "mime" || $alwaysmime)
	  #set( $rendertype = "mime" )
	#end
		
	$context.putPageValue("rendertype", $rendertype)
	
	$context.putPageValue("assetid", $hit.id)
	$context.putPageValue("count", $count )
	$context.putPageValue("sourcepath", $hit.sourcepath )
	
	
	$context.putPageValue("thumbsize", "mediumplus" )
	
	#set($sourcepath = $hit.sourcepath)
	#set($assetwidth = $mediaarchive.getRealImageWidth($hit))
	#if($assetwidth==0 && $rendertype=="audio")
		#set($assetwidth = "300")
		#set($assetheight = "160")
	#else
		#set($assetheight = $mediaarchive.getRealImageHeight($hit))
	#end
	
<div class="stackedplayer masonry-grid-cell assetdraggable ui-draggable" 
	data-assetid="$!hit.id"
	data-width="$assetwidth" 
	data-height="$assetheight" 
	data-draggholderclone="grid-thumbimage" >
	<div class="grid-cell-hover"></div>
	<div class="grid-thumbimage" data-assetid="$!hit.id" >
    	
	   #set($searchhome = "$apphome/views/modules/asset/results/default")
	   $!context.putPageValue("searchhome", $searchhome)

	   #if( ($hit.previewstatus != "2" && $hit.previewstatus != "exif" && $hit.previewstatus != "mime" && $hit.previewstatus != "1" && $hit.previewstatus != "generated") && !$mediaarchive.isCatalogSettingTrue("realtimethumbs"))
	   	 	$pages.include("${searchhome}/convertqueue/previewstatus.html?assetid=$!{hit.id}",$context)
	   	#else
	   		$pages.include("${searchhome}/thumbnails/${rendertype}.html", $context)
	   	#end
	   
   	</div>
	    		
	    		
  	##Caption	
  	<div class="grid-caption grid-caption-${rendertype} #if($rendertype=="default") grid-caption-show #end  draggholder" data-assetid="$!hit.id">
  	
  	 	 #if($stackedfield)
	       	#set($title = $asset.getText($stackedfield,$context))
		 #end
		 
		 #if(!$title)		         	
	     	#if( $asset.assettitle )
	     		#set($title =  $asset.getText("assettitle",$context)) 
	     	#else 
	     		#set($title = $asset.getText("name",$context) )
	     	#end
	     #end

			<div class="grid-caption-link insearch">
				$context.putPageValue("data",$hit)	
				$context.putPageValue("searcher",$mediaarchive.getAssetSearcher() )	
				$context.putPageValue("viewid", "assetstackedgallery")
				$pages.include("/$applicationid/components/xml/detailviewer-stackedgallery.html", $context)
			</div>
         
        #foreach($row in $list)
			#set( $val = false )
			#set( $val = $mediaarchive.getCachedData($fieldid, $row) )
			#if( $val)
				<span class="clipdetail"><a href="${edithome}/tabs/index.html?entityid=$val.getId()&searchtype=$fieldid" class="emdialog">$val</a></span>
			#else
			##Missing: $fieldid = $v
			#end
		#end
      
           
    <div class="grid-gallery-footer d-flex align-items-center justify-content-between"> 
			<div class="d-flex align-items-center"> 
				<div class="d-flex align-items-center ml-1">
					#if($canaddtofavorites)
						<div id="gsassetfavorite-$!{hit.id}" class="media-info-icons mr-1">
							$pages.include("$apphome/views/modules/asset/editor/favorite/index.html?targetdiv=gsassetfavorite", $context)
						</div>
					#end
					#if(($candownload || $canconvert || $candownloadfpo) && $canquickdownload)
						#set($dlink =  "$applink/views/modules/asset/activity/downloadassets.html")
						<a href="$dlink" data-dialogid="downloadfromassethover" class="emdialog mr-1" data-assetid="$hit.id" data-hidefooter="true" title="[[Download]] $!title">
							<i class="bi bi-download ns"></i>
						</a>
					#end
				</div>
			</div>
		</div>

	</div>
</div>