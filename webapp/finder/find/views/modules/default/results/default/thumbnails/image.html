#if(!$title)
	#if( $hit.assettitle )
		#set($title =  $hit.getText("assettitle",$context)) 
	#else 
		#set($title = $hit.getText("name",$context) )
	#end
#end


#set( $imagesize = "image200x200")

#if($thumbsize == "largepreview")
	#if( $type == "video" )
		#set($imagesize = "image640x480")
	#else
		#set($imagesize = "image3000x3000")
	#end
#elseif($thumbsize == "mediumplus")
	#if( $type == "video" )
		#set($imagesize = "image640x480")
	#else
		#set($imagesize = "image550x550")
	#end
#elseif($thumbsize == "postsize")
	#set($imagesize = "image730x480cropped")
#elseif($thumbsize == "small")
	#set($imagesize = "image200x200")
#elseif($thumbsize == "crop")
	#set($imagesize = "image110x62cropped")
#end		

#ifnull($hit)
	#set($hit = $asset)
#end

#set($searchhome = "${apphome}/views/modules/asset/results/default")

$context.putPageValue("searchhome", $searchhome)

#set( $rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))

<div class="emthumbholder draggholder emthumbholder-${rendertype}" data-assetid="${hit.id}">
	
	#if( $hit.previewstatus && $hit.previewstatus == "mime")
		#set ($mime = $mediaarchive.getMimeTypeIcon($hit.fileformat))
		<div class="mimethumbcontainer">
			<i class="bi bi-$!mime mimeicon" title="#if($title)#esc($title)#else$!{hit.name}#end" ></i>
		</div>
	#else	
		#if($useoriginal)
			#set($imagepath = "$siteroot/$mediadbappid/services/module/asset/downloads/originals/"+$mediaarchive.asLinkToOriginal($hit))
		#else
			#set($imagepath = $mediaarchive.asLinkToGenerated($hit, $imagesize))
		#end

		$context.putPageValue("imagepath", $imagepath)
		$context.putPageValue("asset", $hit)
		$context.putPageValue("imagesize", $imagesize)
			
		#set($clearcache = $context.getRequestParameter("clearcache"))
		#ifnotnull($clearcache)
			#set( $time = $context.getLocaleManager().getDateStorageUtil().getTime( $hit.get("assetmodificationdate") ) )
			#set( $urlparams= "?_=$time")
		#end

		#ifnotnull( $boxlookup )
			#set( $box = $boxlookup.get($hit.id) )
			<div class="renderfaceboxes h-100" data-facebox="${box.getBoxArea()}" data-originalwidth="${box.getOriginalWidth()}">

			#if($rendertype == "video")
				#set($imagepath = $mediaarchive.asLinkToGenerateOffset($hit, "image1900x1080", $box.getTimecodeStartSeconds()))
			#end
		#end
			<div class="imagethumbholder">
				<img class="imagethumb img-fluid  img$!thumbsize"
						catalogid="$catalogid" 
						assetid="${hit.id}" 
						alt="#if($title)#esc($title)#else$!{hit.name}#end"
						draggable="true"  
						data-name="#if($title)#esc($title)#else$!{hit.name}#end" 		
						src="${imagepath}$!{urlparams}"
				/>
				#if($picker.getTargetType() != "entity")
					#if($content.isPropertyTrue("showassetpicker"))
						#if( $rendertype == "image")
							#set($originalLink = "$siteroot/$mediadbappid/services/module/asset/downloads/originals/"+$mediaarchive.asLinkToOriginal($hit))
							<div class="pickfromiframe asset" data-imageurl="$!{originalLink}">
								<i class="bi bi-check2-circle"></i>
							</div>
						#end
					#end
				#end
				#if($rendertype =="video")<div class="videoplay-button"><span class="videoplay-icon"></span></div>#end
			</div>
		#ifnotnull( $boxlookup ) 
			</div>  
		#end
	#end
</div>
