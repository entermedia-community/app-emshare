#if(!$title)
	#if( $hit.assettitle )
		#set($title =  $hit.getText("assettitle",$context)) 
	#else 
		#set($title = $hit.getText("name",$context) )
	#end
#end

#set ($thumbsize = $context.getPageValue("thumbsize"))
$context.putPageValue("thumbsize", $thumbsize)

#set( $imagesize = "image200x200.jpg")

#if($thumbsize == "largepreview")
	#if( $type == "video" )
		#set($imagesize = "image640x480.jpg")
	#else
		#set($imagesize = "image3000x3000.jpg")
	#end
#elseif($thumbsize == "mediumplus")
	#if( $type == "video" )
		#set($imagesize = "image640x480.jpg")
	#else
		#set($imagesize = "image550x350.jpg")
	#end
#elseif($thumbsize == "postsize")
	#set($imagesize = "image730x480cropped.jpg")
#elseif($thumbsize == "small")
	#set($imagesize = "image200x200.jpg")
#elseif($thumbsize == "crop")
	#set($imagesize = "image110x62cropped.jpg")
#end		

#ifnull($hit)
#set($hit = $asset)
#end

#set($imagesize = $mediaarchive.exportOutputName($hit, $imagesize))

#set($searchhome = "${apphome}/views/modules/asset/results/default")
$context.putPageValue("searchhome", $searchhome)

<div class="emthumbholder draggholder">
	#if( $hit.importstatus && $hit.importstatus == "uploading" )
		$pages.include("$apphome/views/modules/asset/results/default/uploadqueue/uploadstatus.html?assetid=${hit.id}",$context)	
	#elseif( !$hit.importstatus || $hit.importstatus != "complete" )
		$pages.include("$apphome/views/modules/asset/results/default/convertqueue/importstatus.html?assetid=$!{hit.id}",$context)
	#elseif( $hit.previewstatus && $hit.previewstatus == "mime")
		#set ($mime = $mediaarchive.getMimeTypeIcon($hit.fileformat))

		<div class="mimethumbcontainer">
       		<i class="bi bi-$!mime mimeicon"  title="#if($title)#esc($title)#else$!{hit.name}#end" ></i>
       </div>
	#else	
		#if($useoriginal)
			#set($imagepath = "$siteroot/$mediadbappid/services/module/asset/downloads/originals/"+$mediaarchive.asLinkToOriginal($hit))
		#else
			#set($imagepath = $mediaarchive.asLinkToPreview($hit, $librarycol.id, $imagesize, true))
		#end

		$context.putPageValue("imagepath", $imagepath)
		$context.putPageValue("asset", $hit)
		$context.putPageValue("imagesize", $imagesize)
			
		#set($clearcache = $context.getRequestParameter("clearcache"))
		#ifnotnull($clearcache)
			#set( $time = $context.getLocaleManager().getDateStorageUtil().getTime( $hit.get("assetmodificationdate") ) )
			#set( $urlparams= "?_=$time")
		#end
		
		#if($assetheight && $assetwidth)
			#set($facemanager = $mediaarchive.getBean("faceProfileManager") )
			#set($imagebox = $facemanager.getImageBox( $faceprofilegroups, $hit, $assetwidth, $assetheight) )
		#end
		
		#ifnotnull($imagebox)
			
			#if($imagebox.timecodestartseconds > -1)
				#ifnotnull($urlparams)
					#set($urlparams = "$urlparams&timeoffset=$imagebox.timecodestartseconds")
				#end
				#ifnull($urlparams)
					#set($urlparams = "?timeoffset=$imagebox.timecodestartseconds")
				#end
			#end
	
			<div class="emshowbox faceprofileboximage h-100" 
				data-showbox="$imagebox.locationxy"
				data-imagewidth="${assetwidth}"
				data-inputheight="${assetheight}"
				>
		#end
			<div class="imagethumbholder">
				<img class="imagethumb img-fluid  img$!thumbsize #ifnotnull($imagebox) emshowboximg #end"
						catalogid="$catalogid" 
						assetid="$hit.id" 
						alt="#if($title)#esc($title)#else$!{hit.name}#end"
						draggable="true"  
						data-name="#if($title)#esc($title)#else$!{hit.name}#end" 		
						src="$imagepath$!urlparams" 
				/>
				#if($type =="video")<button class="videoplay-button"><span class="videoplay-icon"></span></button>#end
			</div>
		#ifnotnull($imagebox)
			</div>
		#end
		
					
	#end
</div>


