#if(!$title)
	#if( $hit.assettitle )
		#set($title =  $hit.getText("assettitle",$context)) 
	#else 
		#set($title = $hit.getText("name",$context) )
	#end
#end

#set ($thumbsize = $context.getPageValue("thumbsize"))
$context.putPageValue("thumbsize", $thumbsize)

#set( $imagesize = "image200x200")

#if($thumbsize == "largepreview")
	#if( $type == "video" )
		#set($imagesize = "image640x480")
	#else
		#set($imagesize = "image3000x3000")
	#end
#elseif($thumbsize == "mediumplus")
	#if( $type == "video" )
		#set($imagesize = "image640x480")
	#else
		#set($imagesize = "image550x350")
	#end
#elseif($thumbsize == "postsize")
	#set($imagesize = "image730x480cropped")
#elseif($thumbsize == "small")
	#set($imagesize = "image200x200")
#elseif($thumbsize == "crop")
	#set($imagesize = "image110x62cropped")
#end		

#ifnull($hit)
	#set($hit = $asset)
#end

#set($searchhome = "${apphome}/views/modules/asset/results/default")

$context.putPageValue("searchhome", $searchhome)

#set( $rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))

<div class="emthumbholder draggholder emthumbholder-${rendertype}" data-assetid="$hit.id">
	#if( $hit.importstatus && $hit.importstatus == "uploading" )
		$pages.include("$apphome/views/modules/asset/results/default/uploadqueue/uploadstatus.html?assetid=${hit.id}",$context)	
	#elseif( !$hit.importstatus || $hit.importstatus != "complete" )
		$pages.include("$apphome/views/modules/asset/results/default/convertqueue/importstatus.html?assetid=$!{hit.id}",$context)
	#elseif( $hit.previewstatus && $hit.previewstatus == "mime")
		#set ($mime = $mediaarchive.getMimeTypeIcon($hit.fileformat))
		<div class="mimethumbcontainer">
			<i class="bi bi-$!mime mimeicon" title="#if($title)#esc($title)#else$!{hit.name}#end" ></i>
		</div>
	#else	
		#if($useoriginal)
			#set($imagepath = "$siteroot/$mediadbappid/services/module/asset/downloads/originals/"+$mediaarchive.asLinkToOriginal($hit))
		#else
			#set($imagepath = $mediaarchive.asLinkToGenerated($hit, $imagesize))
		#end

		$context.putPageValue("imagepath", $imagepath)
		$context.putPageValue("asset", $hit)
		$context.putPageValue("imagesize", $imagesize)
			
		#set($clearcache = $context.getRequestParameter("clearcache"))
		#ifnotnull($clearcache)
			#set( $time = $context.getLocaleManager().getDateStorageUtil().getTime( $hit.get("assetmodificationdate") ) )
			#set( $urlparams= "?_=$time")
		#end
		
		#ifnotnull($imagebox)
			
			#if($imagebox.timecodestartseconds > -1)
				#ifnotnull($urlparams)
					#set($urlparams = "$urlparams&timeoffset=$imagebox.timecodestartseconds")
				#end
				#ifnull($urlparams)
					#set($urlparams = "?timeoffset=$imagebox.timecodestartseconds")
				#end
			#end
	
			<div class="emshowbox faceprofileboximage h-100" 
				data-showbox="$imagebox.locationxy"
				data-imagewidth="${assetwidth}"
				data-inputwidth="${assetwidth}"
				data-inputheight="${assetheight}">
		#end
			<div class="imagethumbholder">
				<img class="imagethumb img-fluid  img$!thumbsize #ifnotnull($imagebox) emshowboximg #end"
						catalogid="$catalogid" 
						assetid="$hit.id" 
						alt="#if($title)#esc($title)#else$!{hit.name}#end"
						draggable="true"  
						data-name="#if($title)#esc($title)#else$!{hit.name}#end" 		
						src="$imagepath$!urlparams" 
				/>
				
				#if( $rendertype == "image")
					#set($originalLink = "$siteroot/$mediadbappid/services/module/asset/downloads/originals/"+$mediaarchive.asLinkToOriginal($hit))
					<div class="pickfromiframe" data-imageurl="$originalLink">
						<i class="bi bi-check2-circle"></i>
						<span>[[Pick this image]]</span>
					</div>
				#end
				#if($rendertype =="video")<div class="videoplay-button"><span class="videoplay-icon"></span></div>#end
			</div>
		#ifnotnull($imagebox)
			</div>
		#end
	#end
</div>
