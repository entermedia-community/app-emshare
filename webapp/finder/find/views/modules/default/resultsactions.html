##Header for Modules (not asset)

#set($moduleid = $module.id)
$context.putPageValue("moduleid", $moduleid)

#set($defaultview = $userprofile.getDefaultViewForModule($module.id) )

##if($hits)
	
	#set($resulttype = $userprofile.get("${module.id}-display"))
	#if(!$resulttype)
		#set($resulttype = "table")
	#end
	$context.putPageValue("resulttype", $resulttype)
	
	#set($searchhome = $page.get("searchhome") )
	
	#set( $edit = $context.getRequestParameter("editheader"))
	#if( !$edit || $edit == "false")
		#set( $edit = false)
	#end
	
	#set($entityrendertype = "entity")
	#if ($module.modulerendertype)
		#set($entityrendertype = $module.modulerendertype)
	#end
	$context.putPageValue("entityrendertype", $entityrendertype)
	
	#if(!$resultview)
		#set($resultview = $userprofile.get("$!{module.getId()}resultview"))
		
		#if (!$resultview)
			#set($resultview = $content.get("resultview"))
		#end
		#if (!$resultview)
			#set($resultview = "table")
		#end
	#end
	
	<div id="resultsheader" class="resultsheader">
		<div id="sub-nav" class="search-views emsubnav sub-nav-$!moduleid">
			<ul class="resultsnav">
				#if($permissions.can($moduleid, "create") && $moduleid!="faceprofilegroup")
					#set($addurl = "$siteroot$applink/views/modules/${moduleid}/components/gridsample/preview/$!{entityrendertype}.html?edit=true&addnew=true&viewid=$!{moduleid}addnew")
					#ifnotnull($topentityid)
						#set($addurl = "$addurl&fieldexternalid=${topmodule.getId()}&fieldexternalvalue=${topentityid}&reloadtargets=topmodulecontainer")
					#end
					<li>
						<a class="emdialog resultsnavlink" href="$addurl" title="[[Add New]]">
							<i class="bi bi-plus-lg mr-1"></i> [[New]]
						</a>
					</li>
				#end
					
				#if($resultview == "grid")
					#if($hits.getTotalPages() >  1  )
						$pages.include("$apphome/views/modules/$module.id/navigate.html", $context)
					
					#end
				#end
					
				#if($moduleid != "faceprofilegroup")
					#if(!$edit)
					
						#if($hits && $resultview == "table" && $hits.hasSelections())
							$pages.include("$searchhome/selectionactions.html", $context)
						#end
					#end
				#end
				<li id="filtersselected" class="filtersselected">
					
					#if( $hits.getSearchQuery().hasMainInput())
					#if($moduleid=="asset")
						#if($dialogresults)
							#set($href = "$siteroot$apphome/views/modules/$moduleid/dialogindex.html?hitssessionid=$!hits.getSessionId()&topmoduleid=$!topmoduleid&rootcategory=$!rootcategory&categoryid=$!{categoryid}&removeterm=description")
						#else
							#set($href = "$siteroot$apphome/views/modules/$moduleid/index.html?hitssessionid=$!hits.getSessionId()&topmoduleid=$!topmoduleid&rootcategory=$!rootcategory&categoryid=$!{categoryid}&removeterm=description")		
						#end
						#set($oemaxlevel = "1")
					#else
						#set($href = "$siteroot$apphome/views/modules/$moduleid/index.html?hitssessionid=$!hits.getSessionId()&removeterm=$!term.getId()")
						#set($oemaxlevel = "1")
					#end
					<div class="d-flex align-items-center selected-filters ">
					<a href="$href"
					class="ajax clearsearchbar"
					title="[[Clear]]: #esc($hits.getSearchQuery().getMainInput())"
					data-targetdiv="$!maintargetdiv" 
					data-oemaxlevel="$oemaxlevel"
					data-updateurl="false">
					[[Found]] $hits.size() [[results for]]: <span><b>"$hits.getSearchQuery().getMainInput()"</b></span>
					<i class="bi bi-x ml-1"></i>
					</a>
					</div>

					#end
					
					$pages.include("$componenthome/filters/filters-inline.html", $context)
				</li>
				<li> 
					<div id="resultsmessages"></div>
				</li>	
				
				
				
				
				
				
			</ul>
			
	
		#if($hits)
		<ul class="resultsnavright">
			#if($edit != "true")
				#set($total = $hits.getTotalPages() )
				#if( $total > 1)
					<li class="resultpages">	 
						$pages.include("/${searchhome}/components/results/positions.html", $context)
					</li>
				#end
			#end

			#if (!$resultview || $resultview == 'table')
				#if($canedittablecolumns)
					#if($edit)
						<li class="resultsnavtitem" style="min-width:180px">
							#set ($alldetails = $searcher.getUserPropertyDetails() )
							<span class="hint">*[[Drag columns to move them]]</span>
							<select class="form-control form-control-sm select2 tableresultsaddcolumn" 
									name="addcolumn"
									data-componenthome="$siteroot$componenthome/results/addremovecolumns.html?searchtype=$!moduleid&hitssessionid=$hits.getSessionId()&editheader=true&moduleid=$!moduleid&viewid=$!{moduleid}resultstable"
									data-targetdiv="$!{moduleid}resultsarea"
									data-oemaxlevel="1" 
									data-allowclear="false" >
								<option>[[Add Column]]</option>
								#foreach( $detail in $alldetails) 
									<option value="$detail.id">$detail.getText($context)</option>
								#end
							</select>
						</li>
						##Close Icon
						<li style="border-left: none;background-color: transparent;">
							<a class="ajax table-edit-close" 
								data-targetdiv="$!{moduleid}topcontainer"
								data-oemaxlevel="2" 
								href="${searchhome}/index.html?searchtype=$!moduleid&hitssessionid=$!hits.getSessionId()&editheader=false&moduleid=$!moduleid"><i class="bi bi-x"></i></a>
						</li> 
					#end	
				#end								
			#end
			#set($preferencename = "${moduleid}summary")
			#set($preference = '#set($selectedpreference = ' + '$!userprofile.minimize'  + $preferencename + ')')
			#evaluate($preference)
			#ifnull($selectedpreference)
				#set($selectedpreference = "true")
			#end
			<li class="resultsnavtitem">
				<button class='btn summary-opener #if($selectedpreference == "true") closed #end' data-target="$preferencename">
					<i class="bi bi-chevron-double-left"></i> [[Summary]]
				</button>
			</li>
		</ul>
		#end
	</div>
	</div>
##end

