## Needs $asset
<div id="editfaceprofiles" class="asset-data-detail asset-data-preview assetpanel-editor-box edit-panel-generic">
	<div class="d-flex align-items-center justify-content-between mr-3">
		<h4 class="m-0">[[People]]</h4>
	</div>
	
	$context.putPageValue("clearfilters","true")	
	#set ($viewtype = "faceprofiles")

	$context.putPageValue("thumbsize",$thumbsize)

	<div class="$detailviewercolumnclass asset-data-detail emdatafield-$!viewtype p-3">
		<div class="emfield-scroll" id="entitypickerentityperson">
			#set( $facemanager = $mediaarchive.getBean("faceProfileManager") )
			#set($faceboxescollection =  $facemanager.collectFaceBoxesAllPeople($asset) )
			
			<ul class="entity-value-list d-flex flex-wrap">
			#foreach( $row in $faceboxescollection )
				#set( $rowdata = $row.getEmbeddedData())
				#set( $person = false)
				#set( $person = $row.getPerson() )

				<li class="position-relative facepf-item">

					#set($link = "$!siteroot$applink/views/modules/asset/editors/facesshowsimilar/index.html?hitssessionid=$!hits.sessionId")

					#if($person)
						#set($namefield = $mediaarchive.getSearcher("entityperson").getDetail("name"))
						#set($facename = $mediaarchive.getSearcherManager().getValue($person, $namefield, $context.getLocale()))
					#else
						#set($facename = false)
					#end

					<a href="$link" 
						class="emdialog showimagebox d-flex align-items-center justify-content-between"
						data-dialogwidth="1200"
						data-hidefooter="true"
						data-showboxtarget="mediaplayer"
						data-dialogid="faceprofiledialog"
						data-faceembeddingid="$rowdata.getId()"
						data-assetid="$asset.getId()"
						data-location="${row.toJsonArray()}"
						data-originalwidth="${rowdata.originalwidth}"
						#if($facename)
							data-facename="#elidemiddle($facename, 100)"
							title="[[View more of]] #text($facename)"
						#else
							title="[[View Similar Faces]]"
						#end
						data-dialogtitle="[[Similar Faces]]"
					>

						#set($rendertype = $mediaarchive.getMediaRenderType($asset))
						#if( $rendertype == "video")
							#set( $offset = $rowdata.getValue("timecodestart"))
							#set($imageboxsource = $mediaarchive.asLinkToGeneratedOffset($asset, "image1900x1080" , $offset) )
						#else
							#set($imageboxsource = $mediaarchive.asLinkToGenerated($asset, "image3000x3000"))
						#end

						<div class="d-flex flex-column align-items-center">
							<div class="facepf"
								data-location="${row.toJsonArray()}"
								data-originalwidth="${rowdata.originalwidth}"
								data-originalheight="${rowdata.originalheight}"
								style='background-image: url("${imageboxsource}")'></div>
						</div>
						<div class="vr"></div>
						<div class="d-flex flex-column align-items-center position-relative">
							#if( $rendertype == "video")
								#set($secs = $mediaarchive.formatTime($rowdata.get("timecodestart")) )
							#end
							#ifnotnull($secs)
								<button data-seekto="$offset" class="seekTo" data-vjs='videopreview-${rowdata.get("assetid")}' title="[[Seek to]] $secs">$secs</button>
								<div class="seekPreview" style="display: block;">
									<img src="${imageboxsource}">
								</div>
							#end
							#if($facename)
								<span>$!facename</span>
							#else
								<span class="text-muted">Click to Tag</span>
							#end
						</div>
					</a>
				</li>
			#end	
			</ul>
			#if($faceboxescollection.isEmpty())
				<p class="text-muted">[[No faces detected]]</p>
			#end
			<a href="#" class="manual-fp text-primary border rounded py-1 px-2 d-inline-block mb-2">
				<i class="bi bi-plus-circle mr-1"></i>
				[[Add a Face]]
			</a>
			<hr class="m-0">
			
		</div>
	</div>
</div>
