## Needs $asset
<div id="editfaceprofiles" class="asset-data-detail asset-data-preview assetpanel-editor-box edit-panel-generic">
	<div class="d-flex align-items-center justify-content-between mr-3">
		<h4 class="m-0">[[People]]</h4>
	</div>
	
	$context.putPageValue("clearfilters","true")	
	#set ($viewtype = "faceprofiles")

	$context.putPageValue("thumbsize",$thumbsize)

	<div class="$detailviewercolumnclass asset-data-detail emdatafield-$!viewtype p-3">
		##set($collection =  $asset.getValue("faceprofiles"))
		<div class="emfield-scroll" id="entitypickerentityperson">
			#set( $facemanager = $mediaarchive.getBean("faceProfileManager") )
			#set($faceboxescollection =  $facemanager.collectFaceBoxesAllPeople($asset) )
			
			<ul class="entity-value-list d-flex flex-wrap">
			#foreach( $row in $faceboxescollection )
				#set( $box = $row.getEmbeddedData())	
				#set( $person = $row.getPerson() )
				
				<li class="position-relative facepf-item">

					#set($link = "$!siteroot$applink/views/modules/asset/editors/facesshowsimilar/index.html?hitssessionid=$!hits.sessionId")

					#ifnotnull($person)
						#set($namefield = $mediaarchive.getSearcher("entityperson").getDetail("name"))
						#set($facename = $mediaarchive.getSearcherManager().getValue($person, $namefield, $context.getLocale()))
					#end

					<a href="$link" 
						class="emdialog showimagebox d-flex align-items-center justify-content-between"
						data-width="1200"
						data-hidefooter="true"
						data-showboxtarget="mediaplayer"
						data-dialogid="faceprofiledialog"
						data-faceembeddingid="$box.getId()"
						data-assetid="$asset.getId()"
						data-location="${row.toJsonArray()}"
						data-originalwidth="${box.originalwidth}"
						#ifnotnull($facename)
							data-facename="#elidemiddle($facename, 100)"
							title="[[View more of]] #text($facename)"
						#end
						#ifnull($facename)
							title="[[View Similar Faces]]"
						#end
						data-dialogtitle="[[Similar Faces]]"
					>
						<div>
							#if($row.timecodestart)
								#set($secs = $mediaarchive.formatMilliseconds($row.timecodestart))
							#end

							#set($imageboxsource = $mediaarchive.asLinkToGenerated($asset, "image3000x3000"))
							
							<div class="facepf"
								data-location="${row.toJsonArray()}"
								data-originalwidth="${box.originalwidth}"
								data-originalheight="${box.originalheight}"
								style='background-image: url("${imageboxsource}")'></div>
						</div>
						<div class="vr"></div>
						<div class="d-flex flex-column align-items-center">
							#ifnotnull($facename)
								<span>$!facename</span>
							#end
							#ifnull($facename)
								<span class="text-muted">[[Unknown Person]]</span>
								<small>Click to Tag</small>
							#end
						</div>
					</a>
				</li>
			#end	
			</ul>
			#if($$collection.isEmpty())
				<p class="text-muted">[[No faces Found]]</p>
			#end
			<hr class="m-0">
			
		</div>
	</div>
</div>
