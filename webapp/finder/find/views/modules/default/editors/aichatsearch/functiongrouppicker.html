#set($functionname = $context.getRequestParameter("functionname"))


#ifnotnull($functionname)
	#set($aifunction = $mediaarchive.getCachedData("aifunction", $functionname))
#end

#set($aifunctions = $mediaarchive.query("aifunction").exact("toplevel",true).sort("ordering").search())
#set($toplevelaifunctionid = $currentchannel.get("toplevelaifunctionid"))

<div class="ai-functions mx-2">
  <div class="d-flex align-items-center">
		<div class="dropup">
			<a class="btn btn-cta dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
				<span class="pe-1">
					#ifnull($aifunction)Auto Detect#end
					#ifnotnull($aifunction)#text($aifunction)#end
				</span> 
			</a>
			<div class="dropdown-menu dropdown-menu-end">
					#foreach( $function in $aifunctions )
						<a class="dropdown-item  ajax ai-func #if($toplevelaifunctionid == $function.getId())active#end me-2"
							href="$edithome/functiongroupsave.html"
							data-targetdiv="aichatsearch"
							data-channel="$!{currentchannel.getId()}"
							data-toplevelaifunctionid="$function.id"
							data-functionname="$function.id"
							data-showsuggestions="true"
							data-oemaxlevel="1">
							<i class="bi bi-${function.icon}"></i>
							<span>#text( $function )</span>
						</a>
					#end 
			</div>	
		</div>
  </div>
  $pages.include("${edithome}/suggestions/index.html", $context)
</div>

#if($selectedgroup == "Questions")
  $pages.include("${edithome}/guidebar.html", $context) 
#end
