##$context.putPageValue("hits", $searchcategoryhits)

#set($topcategoryid = $context.getRequestParameter("searchcategory.value"))
$context.putPageValue("topcategoryid", $topcategoryid)

#set($moduleid = $module.id)

#set($expandedmodule = $moduleid)

#set( $parentmodule = $module)
$context.putPageValue("topmodule", $parentmodule)

#set($topentityid = $context.getRequestParameter("topentityid"))

$context.putPageValue("topmoduleid", "searchcategory")
$context.putPageValue("modulecount", $organizedModules.size())
	
$pages.include("${edithome}/categorybreadcrumb.html", $context)

<div class="d-flex h--36">

	#set($selectedmodule = $context.getRequestParameter("selectedmodule"))
	#ifnull($selectedmodule)
		#if($organizedModules.size() == 1)
			#set($selectedmodule = $organizedModules.iterator().next().getId())
		#end
	#end
	$context.putPageValue("selectedmodule",$selectedmodule)
	
	#if( $organizedModules && $organizedModules.size() > 1)
		$pages.include("${edithome}/bymodule.html",$context)
	#end
	
	#set($resultview = $userprofile.get("${module.id}resultview"))
	#ifnull( $resultview)
		#set($resultview = "brickvertical")
	#end
	
	<div class="flex-grow-1 ">
		#if($selectedmodule)
		
			#set($bmodule = $mediaarchive.getCachedData("module",$selectedmodule) )
			
			$context.putPageValue("module", $bmodule)
			
			$context.putPageValue("viewid", "${selectedmodule}resultstable")
			#set($idhits = $organizedHits.get($bmodule.id))
			$context.putPageValue("hits", $idhits)
			$context.putPageValue("enableactions", true)
			
			#if($selectedmodule == "asset")
				#set($edithome = "$apphome/views/modules/asset/editors/quicksearch")										
			#else
				#set($edithome = "$apphome/views/modules/${selectedmodule}/editors/listentities")
				$context.putPageValue("edithome", $edithome)
				$context.putPageValue("edithomeid", "${selectedmodule}listeintities")
			#end
			$pages.include("${edithome}/index.html",$context)

		#else
			
			<div id="searchcategoryresults"	
				class="clickopenentity h-100"
				data-baseurlbar="${apphome}/views/modules/">
					$context.putPageValue("mixedentitysourcetypes", true)
					$pages.include("$searchhome/results.html?resultviewmodulesearch=$resultview",$context)
			</div>
		#end
	</div>
</div>

