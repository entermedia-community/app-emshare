<div class="lightbox-header"> 
  #set( $moduleicon = $selectedbox.moduleicon)
	#ifnull($moduleicon)
	  #set( $moduleicon = "check-circle-fill")
	#end

  <div class="d-flex align-items-center" title="#if($lightboxassets && $lightboxassets.size()>0) $lightboxassets.size() [[Assets]]#end">
    #if($selectedbox)
      <i class="bi bi-${moduleicon}"></i> 
      <strong>#text($selectedbox)</strong>
    #else
      <i class="bi bi-image"></i>
      <strong>[[All Files]]</strong>
    #end
  </div>

  <small><span class="mx-2">&middot;</span>[[Drag and drop selected files from your desktop, to order them or to link with another box]]</small>
  
	#set( $modulelist  = $mediaarchive.getCatalogSettingValue("useexternalsync_modulelist"))
	
	#set( $assetsource = $mediaarchive.getAssetManager().findAssetSource($!entity.get("uploadsourcepath")) )
	#ifnotnull($assetsource)
	
		#set($userlocaldesktoppath  = $assetsource.getConfig().get("userlocaldesktoppath"))
	#end	
	
	<div class="d-flex align-items-center ml-auto">
		<div class="d-flex align-items-center lightbox-header-btns"
		#if($selectedbox) 
			data-lightbox="#text($selectedbox)"
		#else
			data-lightbox=""
		#end
		data-moduleid="$!module.id"
		data-entityid="$!entity.getId()"
		data-path="$category.getCategoryPath()">
		#if ($desktop)
			
			#ifnotnull($userlocaldesktoppath)
				<button class="lightbox-header-btn open-folder" 
					data-root="${userlocaldesktoppath}">
					<i class="bi bi-eye mr-1 ns"></i> <span>[[Open]]</span>
				</button>
			#end
			
			#ifnull($userlocaldesktoppath)

					#set($perm = $module.getBoolean("enableuploading") && $module.id!="faceprofilegroup" && $module.id!="asset" && $module.id!="modulesearch")
					#if($perm)
						#if($permissions.canModule($module, "downloadall"))
						<button class="lightbox-header-btn download-lightbox positive">
							<i class="bi bi-cloud-arrow-down mr-1 ns"></i> <span>[[Download]]</span>
						</button>
						#end
						
					
						<button class="lightbox-header-btn open-folder">
							<i class="bi bi-eye mr-1 ns"></i> <span>[[Open]]</span>
						</button>
						
						
						#if($permissions.canModule($module, "upload_folders"))
						<button class="lightbox-header-btn upload-lightbox">
							<i class="bi bi-cloud-arrow-up mr-1 ns"></i> <span>[[Upload]]</span>
						</button>
						#end
						<button class="lightbox-header-btn scan-changes px-2">
							<i class="bi bi-arrow-repeat ns m-0"></i>
						</button> 
					#end
				#end
			#end
		</div>
		
		#set($showpublishbtn = false)
		#if($permissions.canModule($module, "publishinggallery"))
				#set($showpublishbtn = true) 
		#end
		
		#if ($showpublishbtn) 
			<a href="${edithome}/tabs/index.html"
				class="lightbox-header-btn ajax tabactionexport" 
				data-entitymoduleviewid="${module.id}entityexports"
				data-entityid="$!entity.getId()" 
				data-entitymoduleid="$!module.id"
				data-targetdiv="entitydialog"
				data-oemaxlevel="1"
				data-tabsection="sharegallery"
				data-includeeditcontext="false"
				data-lightboxid="$!{selectedbox.id}">
				<i class="bi bi-send-fill mr-1 ns"></i> [[Publish as Gallery]]
			</a> 
		#end 

		#set( $isowner = $entity.owner == $user.id)

		#if($mediaarchive.isCatalogSettingTrue("ai_create_enabled") && $permissions.canEntity($module, $entity, "createassetswithai"))
			#set($pickerurl = "$!{edithome}/aitools/createassets.html")
			<a class="emdialog btn btn-accent ml-1"
				data-dialogid="createassetswithai"
				data-width="600"
				href="$siteroot$applink/views/modules/contentcreator/editors/contentcreatorasset/index.html?edit=true&addnew=true&withai=true" 
				data-entitymoduleviewid="$entitymoduleviewid"
				data-entitymoduleid="$!module.id"
				data-entityedithome="$!edithome"
				data-entityid="$!entity.id"							
				data-targetdiv="editentitymetadata"
				data-hidefooter="true"
				title="[[Create New]] #text($submodule) [[With AI]]">
				<i class="bi bi-brush mr-1"></i> [[Create With AI]]
			</a>
		#end
	</div>
</div>
