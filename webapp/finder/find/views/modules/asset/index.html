<div id="assetresults">
#set($moduleid = $module.getId())

#if( !$librarycol && $category )
	#set($rootcategories = $category.getParentCategories()) 
	#set( $librarycol = $mediaarchive.query("librarycollection").orgroup("rootcategory", $rootcategories).searchOne() )
#end


#set( $count = $hits.size())
	
#set($entityurl = "$siteroot$apphome/views/modules/$module.id/index.html")

#set( $entities = $userprofile.getEntitiesInParent($category) )


#if( $category)
	$pages.include("$apphome/views/modules/category/showchildren.html", $context)
#end
	


<div class="emgrid-box expandedmodule expandedmoduleasset" style=" margin:0 10px 10px;">
	#set($showentitiesheader = $content.showentitiesheader)
	#ifnull($showentitiesheader)
		#if(!$entities.isEmpty())
		<div class="entitiesontop">
			#foreach ( $data in $entities)
				#set($entity = $data.getData())
				#set($emoduleid = $data.getModuleId()) 
				
				#set($emodule = $mediaarchive.getData("module", $emoduleid))
				
				#set($rendertype = $emodule.modulerendertype)
				#if (!$rendertype)
		   			#set($rendertype = "entity")
				#end
				$context.putPageValue("rendertype", $rendertype)
				$context.putPageValue("rendermoduleid", $emoduleid)
				
				#set($moduleicon = "entity")
		     	#if ($emodule.moduleicon)
		     		#set($moduleicon = $emodule.moduleicon)
		     	#end
			     	
			     	
				#set($previewurl = "$!{siteroot}$apphome/views/modules/$!{emoduleid}/components/gridsample/preview/${rendertype}.html?id=$entity.getId()&hitssessionid=$!hits.sessionId")
				
				$context.putPageValue("hit", $entity)
				<div class="entitycelltop">
				$pages.include("$apphome/views/modules/$!{emoduleid}/components/gridsample/preview/${rendertype}_embeded.html?id=$entity.id", $context)
				</div>
				
			#end
			<div class="clearfix"></div>
		</div>
		#end
	#end
	
	<div class="expandedgrid-subtitle">
 		
  		<h3>
     	#set($moduleicon = "entity")
     	#if ($module.moduleicon)
     		#set($moduleicon = $module.moduleicon)
     	#end
     	
    	#set($entityurl = "$siteroot$apphome/views/modules/$module.id/index.html")

		<img src="$siteroot$apphome/theme/images/entity/${moduleicon}.svg" style="height: 26px;"> 

				#set( $count = $hits.size()) 
				#text($module)
				 <span class="count">($count)</span>
		</h3>
		</div>
	#if($canviewupload || $candownloadcategoryzip)
	<div class="expandedentityactions">
		
		#if($canviewupload)
			<a href="$!{siteroot}$apphome/views/modules/asset/add/start.html" 			
				class="btn-sm btn-blue ajax"
				data-targetdivinner="applicationmaincontent"
				data-oemaxlevel="2"
				data-categoryid="$!category.getId()"
				data-clearotherentities="true"
				title="[[Upload Media to]]: #text($category)">
			<i class="fas fa-file-upload"></i> [[Upload]]</a>
		#end
		<div class="loadericon" 
			style="padding:0px 4px 4px 6px; "><i class="fas fa-spinner fa-spin"></i></div>
			
   		
   		#if($candownloadcategoryzip)
	   		#if($category)
			<a	class="btn-sm btn-blue "
	  				title="[[Download]]: $category.getName()"
	  				href="$applink/views/modules/asset/downloads/bycategory/${category.id}/#eid($category.name).zip">
	  				<i class="fa fa-download" aria-hidden="true"></i> [[Download]]</a>
			#end
		#end
			
	</div>	
	#end
	
		
	
	<div class="clearfix"></div>
	
	
	
	
	
	##<div id="${moduleid}resultsarea" class="resultsarea" >
		$pages.include("$componenthome/results/index.html", $context)
		##<div class="clearfix"></div>
	##</div>
</div>


</div>
