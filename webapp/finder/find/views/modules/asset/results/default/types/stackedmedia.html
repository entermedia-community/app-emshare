#if(!$ismodulesearch)
		#set ( $ismodulesearch = $content.get("ismodulesearch") )
#end
#if(!$ismodulesearch)
	#set ( $ismodulesearch = $context.getRequestParameter("ismodulesearch") )
#end

#if( $hideheader &&  $hideheader != "true")
	$pages.include("${searchhome}/resultheader.html",$context) 
#end
#ifnull($lightboxassetsresults)
	#set($lightboxassetsresults = $context.getRequestParameter("lightboxassetsresults"))
	$context.putPageValue("lightboxassetsresults", $lightboxassetsresults)
#end

#ifnull($sortableassets)
	#set($sortableassets = $context.getRequestParameter("sortableassets"))
	$context.putPageValue("sortableassets",$sortableassets)
#end

<div class="scrollview">
<div class="masonry-grid" 
	data-maxheight="200" 
	data-cellpadding="4"
	data-stackedviewpath="${apphome}/views/modules/asset/results/default/types/stackedmedia.html"
>

#set($count = 0)
#set($viewerlink = $content.get("assetviewerlink") )
#set($stackedfield = $mediaarchive.getCatalogSettingValue("stackedgalleryfield"))

#set($isdraggable = false)
#if($module && $permissions.canModule($module, "assign_files"))
	#set($isdraggable = true)
#end

#foreach( $hit in $hits.getPageOfHits())
	
	$context.putPageValue("hit", $hit)
	
	
	#set($type = $hit.getSearchHit().getType())
	$context.putPageValue("type", $type)

	#set($rendertype = $mediaarchive.getMediaRenderType($hit.fileformat))
	$context.putPageValue("rendertype", $rendertype)

	#set($sourcepath = $hit.sourcepath)
	$context.putPageValue("sourcepath", $hit.sourcepath )
	
	$context.putPageValue("assetid", $hit.id)
	$context.putPageValue("count", $count )

	$context.putPageValue("thumbsize", "mediumplus" )
	
	#set($assetwidth = $mediaarchive.getRealImageWidth($hit))
	$context.putPageValue("assetwidth", "assetwidth" )
	
	#set($assetheight = $mediaarchive.getRealImageHeight($hit))
	$context.putPageValue("assetheight", "assetheight" )
	
	#set($click = "$siteroot$viewerlink?hitssessionid=${hits.getSessionId()}&assetid=${hit.id}")
	$context.putPageValue("click", "click" )
	
	#set($isselected = $hits.isSelectedOnPage(${hit.id}) )
	$context.putPageValue("isselected", "isselected" )
	
	<div class="resultsdivdata masonry-grid-cell stackedplayer-cell resultsassetcontainer  #if($isdraggable)assetdraggable#end #if($isselected) emrowselected #end " 
		id="gallerycell_$!{hit.id}"
		data-assetid="$!{hit.id}"
		data-dataid="$!{hit.id}"
		data-ordering="$!{hit.ordering}"
		style="height:180px;width:250px;" 
		#if($rendertype == "audio")
			data-width="220"
			data-height="180"
		#else
			data-width="$assetwidth"
			data-height="$assetheight"
			$context.putPageValue("thumbheight", "180" ) 
		#end
		>
		<div class="#if($isdraggable)assetdroppable sort-droppable #end" data-dataid="$hit.id">
		$pages.include("${searchhome}/thumbnails/brick.html", $context)
		</div>
		
	</div>
    #set ( $count = $count + 1) 
#end

#if($hits.getPageOfHits().size() == 0)
	$pages.stream("$!{searchhome}/empty.html", $context)
#end
</div>
</div>
