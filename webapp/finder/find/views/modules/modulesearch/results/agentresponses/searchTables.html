

<div class="quicksearchresults">
	#set( $input = $keywordsstring)

	#ifnull($input)
		#set( $input = $keywords)
	#end
	#if(!$input)
		#set( $input = $organizedResults.getEntityResults().getSearchQuery().getMainInput())
	#end

	#if($organizedResults.isEmpty())
		<div class="text-secondary py-3 text-center">
			<messageplain>We did not find any results for your search.</messageplain>
			[[No results found]] #ifnotnull($input) [[for]] <strong>#esc($input)</strong> #end #ifnotnull($modulenamestext) [[in]] <strong>#esc($modulenamestext)</strong> #end
		</div>
	#end
	
	#set($aisearch = $agentcontext.getAiSearchParams())
	<div class="mb-3">
	[[Searched for]] 
	#ifnotnull($aisearch.getStep2())
		#set($searchstep = $aisearch.getStep2())
			#foreach($module1 in $searchstep.getModules())
				#text($module1)
				#if( $foreach.hasNext )
					#if($foreach.count == $searchstep.getModules().size() - 1)
					[[or]] 
					#else
				    , 
					#end
				 #end
			#end
			
			#set($keywords = $aisearch.getStep2().getParameterValues())
			#ifnotnull($keywords)
				<span class="text-muted">(keywords: <em>$keywords</em>)</span>
			#end
			
			within $aisearch.getStep1().getModule() 
			
			#set($keywords = $aisearch.getStep1().getParameterValues())
			#ifnotnull($keywords)
				filtered by <em>$keywords</em>
			#end
			
	#end
	#ifnull($aisearch.getStep2())
		#set($searchstep = $aisearch.getStep1())
		#foreach($module1 in $searchstep.getModules())
			#if($module1.id == "modulesearch")
				[[All Modules]]
			#else
				#text($module1)
			#end
			#if( $foreach.hasNext )
				#if($foreach.count == $searchstep.getModules().size() - 1)
				or 
				#else
			    , 
				#end
			 #end
		#end
		#set($keywords = $aisearch.getStep1().getParameterValues())
		#ifnotnull($keywords)
			<span class="text-muted">(keywords: <em>$keywords</em>)</span>
		#end
	#end			
				
	found:  
	<a href="$!searchurl" 
		class="ajax" 
		data-targetdiv="applicationmaincontent" 
		data-oemaxlevel="3" 
		data-updateurl="true" 
		data-hitsessionid="$hits.getSessionId()"
		title="[[View]] #text($module)"
		data-closedialog="true">
			$searchstep.getCount() records</a>
		
	</div>
	##$context.putPageValue("hidemoduleheaders", true)

	#foreach($module in $organizedResults.getModules() )
		#set($hits = $organizedResults.getByType($module.id,$context))
		$context.putPageValue("module", $module)
		$context.putPageValue("moduleid", $module.id)
		$context.putPageValue("hits", $hits)
		
		
		
		#if( $module.id == "asset")
			##TODO: Blockfind picker, picker is not enabled in the agent context, enable it via Java Script?
			#if($picker && $picker.isPickerEnabled("asset", $module.id))
				$context.putPageValue("pickerenabled", true)
			#end
			$pages.include("./renderassetresults.html",$context)
		#else
			#if($picker && $picker.isPickerEnabled("entity", $module.id))
				$context.putPageValue("pickerenabled", true)
			#end
			$pages.include("./rendermoduleresults.html",$context)
		#end
				
	#end
</div>

#ifnotnull($semanticquery)
  $agentcontext.setNextFunctionName("searchSemantic")
  $agentcontext.setValue("semanticquery", $semanticquery)
#end