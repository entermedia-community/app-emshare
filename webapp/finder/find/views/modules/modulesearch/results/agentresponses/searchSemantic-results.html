<messageplain>
	Found $semanticentities.size() suggested records and $semanticassethits.size() assets
</messageplain>
#if( $semanticentities.size() > 0 || $semanticassethits.size() > 0 )
<div class="p-2 bg-light mt-3 mb-1 shadow-sm border rounded">
  <div class="mt-2 ml-2 mb-0 qsresultsEntity d-flex align-items-center">
    <i class="bi bi-stars module-icon" style="font-size:0.9em;line-height:1;opacity:0.85;"></i>  
    <span class="qsresultsEntitytext">Related Results</span>
  </div>
  <hr>

  #foreach($module in $semanticentities)
    #set($hits = $semanticentityhits.get($module.id))
    #ifnotnull($hits)
      $context.putPageValue("module", $module)
      $context.putPageValue("moduleid", $module.id)

      #set($moduleicon = "grid")
      #if ($module.moduleicon)
        #set($moduleicon = $module.moduleicon)
      #end

      <div class="m-0 qsresultsEntity d-flex align-items-center">
        <i class="bi bi-$moduleicon module-icon"></i>
        <span class="qsresultsEntitytext">#text($module)</span>
      </div>

      $context.putPageValue("rendermoduleid", $module.id)

      $hits.setHitsPerPage(10)
      $context.putPageValue("hits", $hits)

      $context.putPageValue("searchresults", true)
      $context.putPageValue("searchhome", "$apphome/views/modules/${module.id}/results/default")

      <div class="emgridflex">  	
        <div id="galleryimg-entitiy" 
          class='emgrid #if($section != "favorites")emgridlimited#end entitiescontainer emgridquickresults' 
          style="width:100%"
          data-fixedwidth="180" 
          data-cellpadding="10"
          data-entityrenderurl="$!{siteroot}$apphome/views/modules/${module.id}/editors/default/tabs/gridcell.html"
          data-rendertype="$!rendertype">
          #foreach( $hit in $hits.getPageOfHits() )
            $context.putPageValue("hit", $hit)
            #set($rendertype = $module.modulerendertype)
            #if (!$rendertype)
                #set($rendertype = "entity")
            #end
            <messageplain>Suggested Entity Search Result#${foreach.count}</messageplain>
            <messageplain>Entity ID: ${hit.id}</messageplain>
            <messageplain>Entity Name: ${hit.name}</messageplain>
            <messageplain>Module ID: ${$module.id}</messageplain>
            #ifnotnull($hit.primaryimage)
            <messageplain>Primary Image ID: ${hit.primaryimage}</messageplain>
            #end
            #ifnull($hit.primaryimage)
              #ifnotnull($hit.primarymedia)
              <messageplain>Primary Image ID: ${hit.primarymedia}</messageplain>
              #end
            #end
            <div class="emgridcell emgridcellqs emgridcell-$rendertype activelistcontainer 
            #if($selectedid == $hit.getId() || $topselectedid == $hit.getId()) active #end">

              $pages.include("$apphome/views/modules/$!{module.id}/results/default/types/qsresult.html", $context)

              #set($highlight =  $hits.highlight($hit, "description", 20, true))
              #if($highlight)
              <div class="gridcellhighlight">$highlight</div>
              #end
            </div>
          #end
        </div>
      </div>
    #end
  #end

  #if($semanticassethits)
    #set($searchhome = "$apphome/views/modules/asset/results/default")
    $context.putPageValue("searchhome", $searchhome)
    <div class="masonry-grid mt-3" 
      data-maxheight="140" 
      data-cellpadding="10"
      data-makebox="true"
      data-visibleposition="$!semanticassethits.getStartingPosition()">

      #foreach( $hit in $semanticassethits.getPageOfHits() )
        <messageplain>Suggested Asset Search Result#${foreach.count}</messageplain>
        <messageplain>Asset ID: ${hit.id}</messageplain>
        <messageplain>Asset Name: ${hit.name}</messageplain>
        $context.putPageValue("hit", $hit)
        $pages.include("${searchhome}/types/media.html", $context)
      #end
    </div>
  #end
</div>
#end
