#set($description = "Generates metadata for an entity based on the following fields: ")
#foreach($field in $contextfields)
	#if($foreach.count>1)
	#set($description = "$description,")
#end
	#if($field.isList())
		#set($description = "$description \n ${field.name}:")
		#foreach( $option in $mediaarchive.getValueList($field, $entity) )
			#if($foreach.count>1)
				#set($description = "$description,")
			#end
			#set($description = "$description #text($option)")
		#end
	#elseif($field.isBoolean())
		#set($description = "$description \n ${field.name}:")
		#if($entity.getBoolean($field.id)) 
			#set($description = "$description \n ${field.name}: Yes")
		#else
			#set($description = "$description \n ${field.name}: No")
		#end
	#elseif($field.isDate())
		## SKIP
	#else
		#set($description = "$description \n ${field.name}: ${entity.get($field.id)}")
	#end
#end
{
  "name": "generate_metadata_entity",
  "description": #jesc($description),
  "parameters": {
    "type": "object",
    "properties": {
      "metadata": {
        "type": "object",
        "properties": {
		  #foreach($field in $fieldstofill)
			  #if($foreach.count>1)
			  ,
			  #end
				#if($field.isList())
					"$field.id": {
						"type": "string",
						"description": "$field.aicreationcommand",
						"enum": [
							#foreach( $option in $mediaarchive.getList($field.getListId()) )
								#if($foreach.count>1)
								,
								#end
								#jesc("$option.id|#text($option)")
							#end
						]
					}
				#else
					"$field.id": {
						"type": "string",
						"description": "$field.aicreationcommand"
					}
				#end
		  #end
				},
        "required": [
			#foreach($field in $fieldstofill)
				#if($foreach.count>1)
				,
				#end
			  	"$field.id" 						
			#end 
        ]
      }
    },
    "required": ["metadata"]
  }
}
