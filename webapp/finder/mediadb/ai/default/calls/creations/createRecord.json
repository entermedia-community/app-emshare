{
	"model": "${model}",
	"messages": [
		{
			"role": "system",
			"content": "You are an assistant that extracts structured details for an entity creation request."
		}
		#if($channelchathistory.size() <= 1)
		, 
		#else 
		$pages.include("../commons/messagehistory.json", $context) 
		#end
		{
			"role": "user",
			"content": #jesc(${message.message})
		}
	],
	"response_format": {
		"type": "json_schema",
		"json_schema": {
			"name": "create_record_request",
			"strict": true,
			"schema": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"description": "The exact name of the item to create"
					},
					"module": {
						"type": "string",
						"description": "The module to create the items in",
						"enum": [
						#set($modules = $assistant.loadUserSearchModules($chatprofile))
						#foreach($module in $modules)
							#if($foreach.count>1),#end
							"${module.id}|${module.name}"
						#end
						]
					},
					"fields": {
						"type": "object",
						"properties": {
							"tags": {
								"type": "array",
								"items": { "type": "string" },
								"description": "The tags to assign to the created items"
							},
							"description": {
								"type": "string",
								"description": "The description to assign to the created items"
							}
						}
					},
					"explainer": {
						"type": "string",
						"description": "Explain what action is going to be taken in a human readable sentence. Example: 'Creating an entity named Sunset in Photos'"
					}
				},
				"required": ["name", "module"]
			}
		}
	}
}
