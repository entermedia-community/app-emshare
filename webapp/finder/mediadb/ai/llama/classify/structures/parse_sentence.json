{
    "model": "${model}",
    "messages": 
[
    {
        "role": "system",
        "content": [
            {
            "type": "text",
			
            "text": #jesc("You are an assistant that maps natural language requests to a logical steps that could be executed as sequential database or API operations. 

You will first determine the request type, which is one of these values: 'conversation', 'search', 'create_image', 'create_entity'.

You will then return a response in the matching JSON structure from the following OpenAI schema format:

$structure

If not clear which request type to use, use 'conversation' and ask for clarification.
Always return valid JSON without any additional text.
")
            }
        ]
    },
    $pages.include("/$mediaarchive.getMediaDbId()/ai/llama/assistant/instructions/messagehistory.json", $context)
	{
	    "role": "user",
        "content": [
            {
                "type": "text",
                "text":  #jesc(${message.message})
            }
        ]
    }
]
}