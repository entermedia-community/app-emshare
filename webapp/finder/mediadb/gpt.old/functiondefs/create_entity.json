
#set($searcher = $mediaarchive.getSearcher($targetmodule.id))
#set($viewid = "${targetmodule.id}aifields")
#set($viewdata = $mediaarchive.getData("view", $viewid))

#ifnull($viewdata)
	#set($viewdata = $mediaarchive.getData("view", "${targetmodule.id}addnew"))
#end
#set($details = $searcher.getDetailsForView($viewdata.id))
{
    "name": "create_entity",
    "description": "Generates metadata for a new Entity in the ${targetmodule.name} module.",
    "parameters": {
        "type": "object",
        "properties": {
            #foreach($detail in $details)
                "$detail.id": {
                    "type": 
                            #if($detail.dataType == "boolean") "boolean"
                            #elseif($detail.dataType == "list" || $detail.isMultiValue()) "array"
                            #else "string" #end,
                    "description": "$detail.name $!detail.note"
                    #if($detail.dataType == "list" || $detail.isMultiValue()),
                    "items": {
                        "type": "string"
                        #if($mediaarchive.getList($detail.id).size() > 0),
                        "enum": [
                            #foreach($option in $mediaarchive.getList($detail.id))
                                "$option.id"#if($foreach.count < $mediaarchive.getList($detail.id).size()),#end
                            #end
                        ]
                        #end
                    }
                    #end
                }#if($foreach.count < $details.size()),#end
            #end
        },
        "required": [
            #set($added = false)
            #foreach($detail in $details)
                #if($detail.isRequired())
                    #if($added), #end"$detail.id"
                    #set($added = true)
                #end
            #end
        ]
    }
}
